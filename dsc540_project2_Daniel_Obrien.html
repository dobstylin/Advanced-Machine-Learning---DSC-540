<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>



dsc450_project2_Daniel_Obrien

















    
    
    
    

  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>DSC540 Project 2<a rel="noopener" class="anchor-link" href="#DSC540-Project-2">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>DePaul University<br/>
Ilyas Ustun, PhD<br/>
Chicago, IL</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Rules<a rel="noopener" class="anchor-link" href="#Rules">&#182;</a></h2><ul>
<li>Do not change the code already present in the notebook.</li>
<li>Write your code under the corresponding questions where you see <code># Code here</code>. You are encouraged to use more than one cell.</li>
<li>Provide explanation in a separate Markdown formatted cell. </li>
<li>You can change the cell type by:<ul>
<li>Clicking on the outer area of the cell type you want to change,</li>
<li>Go to the top, and select either Code or Markdown from the dropdown menu.</li>
</ul>
</li>
<li>Be concise in your explanations and conclusions.</li>
<li>Write clear code and provide explanation to functions you create by using <code>#</code> comment sign.</li>
<li>For built-in function and methods you use from libraries, provide a very brief explanation of what they do.</li>
<li>Try to answer the questions by yourself. Use documentation from pandas, sklearn and similar libraries to solve the problem.</li>
<li>If you are stuck you can use different resources. Do not find an identical project and copy paste the solutions. </li>
<li>Write your name before beginning to code.</li>
</ul>
<blockquote><p><strong>Once you have completed your project, and you are done with coding restart your kernel and run everything. Make sure it runs without errors.</strong></p>

<pre><code>- For this go to the very top where the tabs are located:
    - Kernel  
        - Restart &amp; Run All  
- We will check whether the code and results in this notebook is running fine.  </code></pre>
</blockquote>
<p>Important:</p>
<ul>
<li><strong>Do NOT share the solutions with other people.</strong></li>
<li><strong>Do NOT share the solutions on the internet including but not limited to Github and other platforms.</strong></li>
<li>Sign the Honor Pledge below indicating that you have agreed to these rules listed here, and any other ethical and honor rules as required by the university.</li>
</ul>
<ul>
<li><strong>Deliverables:</strong><ol>
<li>The Python Jupyter notebook file named properly with your name. Example: dsc540_project1_john_doe.ipynb</li>
<li>The HTML output of this code notebook names the same way. Example: dsc540_project1_john_doe.html<ul>
<li>File -&gt; Download as -&gt; HTML   </li>
</ul>
</li>
<li>The label predictions as csv file. -&gt; See last question.</li>
</ol>
</li>
</ul>
<p>Good Luck!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Daniel O&#39;Brien<a rel="noopener" class="anchor-link" href="#Daniel-O&#39;Brien">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Honor Pledge:</strong><br/>
I pledge on my honor that I, <strong>Daniel O&#39;Brien</strong>, have followed the rules listed above, that I have not given or received any unauthorized assistance on this assignment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Project Description<a rel="noopener" class="anchor-link" href="#Project-Description">&#182;</a></h2><p>For this project we will be exploring publicly available data from <a rel="noopener" href="www.lendingclub.com">LendingClub.com</a>.<br/>
Lending Club connects people who need money (borrowers) with people who have money (investors).<br/>
Hopefully, as an investor you would want to invest in people who showed a profile of having a high probability of paying you back. We will try to create a model that will help predict this.</p>
<p>Check out more info on Lending Club on <a rel="noopener" href="https://en.wikipedia.org/wiki/Lending_Club">Wikipedia</a>. Lending Club also had a <a rel="noopener" href="https://en.wikipedia.org/wiki/Lending_Club#2016">very interesting year in 2016</a>.</p>
<p>This dataset is from before they went public.</p>
<p>We will use lending data from 2007-2010 and will try to classify and predict whether or not the borrower paid back their loan in full. You will analyze the data file provided.</p>
<p>Here are what the columns represent:</p>
<ul>
<li>credit.policy: 1 if the customer meets the credit underwriting criteria of LendingClub.com, and 0 otherwise.</li>
<li>purpose: The purpose of the loan (takes values &quot;credit_card&quot;, &quot;debt_consolidation&quot;, &quot;educational&quot;, &quot;major_purchase&quot;, &quot;small_business&quot;, and &quot;all_other&quot;).</li>
<li>int.rate: The interest rate of the loan, as a proportion (a rate of 11% would be stored as 0.11). Borrowers judged by LendingClub.com to be more risky are assigned higher interest rates.</li>
<li>installment: The monthly installments owed by the borrower if the loan is funded.</li>
<li>log.annual.inc: The natural log of the self-reported annual income of the borrower.</li>
<li>dti: The debt-to-income ratio of the borrower (amount of debt divided by annual income).</li>
<li>fico: The FICO credit score of the borrower.</li>
<li>days.with.cr.line: The number of days the borrower has had a credit line.</li>
<li>revol.bal: The borrower&#39;s revolving balance (amount unpaid at the end of the credit card billing cycle).</li>
<li>revol.util: The borrower&#39;s revolving line utilization rate (the amount of the credit line used relative to total credit available).</li>
<li>inq.last.6mths: The borrower&#39;s number of inquiries by creditors in the last 6 months.</li>
<li>delinq.2yrs: The number of times the borrower had been 30+ days past due on a payment in the past 2 years.</li>
<li>pub.rec: The borrower&#39;s number of derogatory public records (bankruptcy filings, tax liens, or judgments).</li>
<li>not.fully.paid: Whether the loan was paid back or not.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Import Libraries<a rel="noopener" class="anchor-link" href="#Import-Libraries">&#182;</a></h2><p><strong>Import the usual libraries for pandas and plotting, and sklearn.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[112]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn</span>
<span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;0.23.1&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>These are the packages I used<a rel="noopener" class="anchor-link" href="#These-are-the-packages-I-used">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span><span class="p">,</span> <span class="n">plot_tree</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q1<a rel="noopener" class="anchor-link" href="#Q1">&#182;</a></h1><ul>
<li>Read in the dataset <code>loan_data.csv</code></li>
<li>How many rows and variables are there?</li>
<li>What are the unique values of <code>not.fully.paid</code>?</li>
<li><code>not.fully.paid</code> having a value of 1 means that the person who took the loan did not fully pay it back. What&#39;s the proportion of those people in the full dataset?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Get the Data<a rel="noopener" class="anchor-link" href="#Get-the-Data">&#182;</a></h2><p><strong>Use pandas to read loan_data.csv as a dataframe called loans.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;loans_train.csv&#39;</span><span class="p">)</span>
<span class="n">loans_outcome_not_known</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;loans_outcome_not_known.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>credit.policy</th>
      <th>purpose</th>
      <th>int.rate</th>
      <th>installment</th>
      <th>log.annual.inc</th>
      <th>dti</th>
      <th>fico</th>
      <th>days.with.cr.line</th>
      <th>revol.bal</th>
      <th>revol.util</th>
      <th>inq.last.6mths</th>
      <th>delinq.2yrs</th>
      <th>pub.rec</th>
      <th>not.fully.paid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>credit_card</td>
      <td>0.0800</td>
      <td>101.85</td>
      <td>10.596635</td>
      <td>10.26</td>
      <td>747</td>
      <td>7560.000000</td>
      <td>18467</td>
      <td>30.9</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>all_other</td>
      <td>0.1114</td>
      <td>328.04</td>
      <td>10.530495</td>
      <td>14.13</td>
      <td>722</td>
      <td>1920.000000</td>
      <td>6811</td>
      <td>56.8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>debt_consolidation</td>
      <td>0.1324</td>
      <td>676.20</td>
      <td>11.289782</td>
      <td>20.73</td>
      <td>697</td>
      <td>4080.000000</td>
      <td>16805</td>
      <td>64.1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>debt_consolidation</td>
      <td>0.1103</td>
      <td>671.44</td>
      <td>10.555813</td>
      <td>15.72</td>
      <td>722</td>
      <td>3580.041667</td>
      <td>31566</td>
      <td>32.3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>debt_consolidation</td>
      <td>0.1545</td>
      <td>244.21</td>
      <td>10.308953</td>
      <td>18.80</td>
      <td>647</td>
      <td>1950.041667</td>
      <td>4587</td>
      <td>41.0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans_outcome_not_known</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>credit.policy</th>
      <th>purpose</th>
      <th>int.rate</th>
      <th>installment</th>
      <th>log.annual.inc</th>
      <th>dti</th>
      <th>fico</th>
      <th>days.with.cr.line</th>
      <th>revol.bal</th>
      <th>revol.util</th>
      <th>inq.last.6mths</th>
      <th>delinq.2yrs</th>
      <th>pub.rec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>debt_consolidation</td>
      <td>0.1324</td>
      <td>540.96</td>
      <td>10.596635</td>
      <td>11.73</td>
      <td>672</td>
      <td>3210.000000</td>
      <td>5671</td>
      <td>55.1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>educational</td>
      <td>0.1221</td>
      <td>333.15</td>
      <td>11.156193</td>
      <td>15.82</td>
      <td>707</td>
      <td>5314.000000</td>
      <td>107643</td>
      <td>81.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>debt_consolidation</td>
      <td>0.1218</td>
      <td>166.50</td>
      <td>10.753836</td>
      <td>6.38</td>
      <td>772</td>
      <td>1440.000000</td>
      <td>233</td>
      <td>6.7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>major_purchase</td>
      <td>0.1461</td>
      <td>124.12</td>
      <td>10.239960</td>
      <td>0.00</td>
      <td>692</td>
      <td>1530.041667</td>
      <td>0</td>
      <td>0.0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>credit_card</td>
      <td>0.0800</td>
      <td>156.69</td>
      <td>10.434116</td>
      <td>15.85</td>
      <td>767</td>
      <td>10170.000000</td>
      <td>5748</td>
      <td>12.3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Check out the info(), head(), and describe() methods on loans.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7478 entries, 0 to 7477
Data columns (total 14 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   credit.policy      7478 non-null   int64  
 1   purpose            7478 non-null   object 
 2   int.rate           7478 non-null   float64
 3   installment        7478 non-null   float64
 4   log.annual.inc     7478 non-null   float64
 5   dti                7478 non-null   float64
 6   fico               7478 non-null   int64  
 7   days.with.cr.line  7478 non-null   float64
 8   revol.bal          7478 non-null   int64  
 9   revol.util         7478 non-null   float64
 10  inq.last.6mths     7478 non-null   int64  
 11  delinq.2yrs        7478 non-null   int64  
 12  pub.rec            7478 non-null   int64  
 13  not.fully.paid     7478 non-null   int64  
dtypes: float64(6), int64(7), object(1)
memory usage: 818.0+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(7478, 14)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans_outcome_not_known</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2100, 13)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>For the loans train dataset, there are 7,478 rows and 14 columns and for the loans_outcome_not_known there are 2,100 rows and 13 columns. The column included in the loans train dataset, that is missing from the loans outcomes not know dataset, is the not.fully.paid column which indicates whether loans have been fully repaid or not.<a rel="noopener" class="anchor-link" href="#For-the-loans-train-dataset,-there-are-7,478-rows-and-14-columns-and-for-the-loans_outcome_not_known-there-are-2,100-rows-and-13-columns.-The-column-included-in-the-loans-train-dataset,-that-is-missing-from-the-loans-outcomes-not-know-dataset,-is-the-not.fully.paid-column-which-indicates-whether-loans-have-been-fully-repaid-or-not.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="n">loans</span><span class="p">[</span><span class="s1">&#39;not.fully.paid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">count</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    6045
1    1433
Name: not.fully.paid, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The two uniques values for &#39;not.fully.paid&#39; are 0 and 1. There are 6,045 rows with a value of 0 and 1,433 rows with a value of 1.<a rel="noopener" class="anchor-link" href="#The-two-uniques-values-for-&#39;not.fully.paid&#39;-are-0-and-1.-There-are-6,045-rows-with-a-value-of-0-and-1,433-rows-with-a-value-of-1.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">prop1</span> <span class="o">=</span> <span class="mi">1433</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1433</span> <span class="o">+</span> <span class="mi">6045</span><span class="p">)</span>
<span class="n">prop1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.19162877774806097</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>About 19% of people who took out loans did not fully pay back their loans.<a rel="noopener" class="anchor-link" href="#About-19%-of-people-who-took-out-loans-did-not-fully-pay-back-their-loans.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q2<a rel="noopener" class="anchor-link" href="#Q2">&#182;</a></h1><ul>
<li>Visual and Exploratory Analysis</li>
<li>Carry out the tasks given below</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Exploratory Data Analysis<a rel="noopener" class="anchor-link" href="#Exploratory-Data-Analysis">&#182;</a></h2><ul>
<li>Let&#39;s do some data visualization! </li>
<li>You can use many different visualization libraries including matplotlib, seaborn, pandasand many more. Feel free to use whatever library you want. Don&#39;t worry about the colors matching, just worry about getting the main idea of the plot.</li>
</ul>
<p><strong>Create a histogram of two FICO distributions on top of each other, one for each credit.policy outcome.</strong></p>
<p><em>Note: You&#39;ll probably need one line of code for each histogram, I also recommend just using pandas built in .hist()</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;fico&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;credit.policy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc2ce398880&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc2ce526d30&gt;],
      dtype=object)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">CreditGood</span> <span class="o">=</span> <span class="n">loans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loans</span><span class="p">[</span><span class="s1">&#39;credit.policy&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">CreditBad</span> <span class="o">=</span> <span class="n">loans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loans</span><span class="p">[</span><span class="s1">&#39;credit.policy&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">CreditGood</span><span class="p">[</span><span class="s1">&#39;fico&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">CreditBad</span><span class="p">[</span><span class="s1">&#39;fico&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc2c959b910&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The histograms above, show that when customers meet the credit criteria they have higher FICO scores overall, than customers who do not meet the credit underwriting criteria.<a rel="noopener" class="anchor-link" href="#The-histograms-above,-show-that-when-customers-meet-the-credit-criteria-they-have-higher-FICO-scores-overall,-than-customers-who-do-not-meet-the-credit-underwriting-criteria.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Create a similar figure, except this time select by the not.fully.paid column.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">FullyPaid</span> <span class="o">=</span> <span class="n">loans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loans</span><span class="p">[</span><span class="s1">&#39;not.fully.paid&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">NotFullyPaid</span> <span class="o">=</span> <span class="n">loans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loans</span><span class="p">[</span><span class="s1">&#39;not.fully.paid&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">FullyPaid</span><span class="p">[</span><span class="s1">&#39;fico&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">NotFullyPaid</span><span class="p">[</span><span class="s1">&#39;fico&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc2cdeb0460&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The histogram above shows that customers who fully paid back their loans have higher FICO scores than customers who did not pay back their loans.<a rel="noopener" class="anchor-link" href="#The-histogram-above-shows-that-customers-who-fully-paid-back-their-loans-have-higher-FICO-scores-than-customers-who-did-not-pay-back-their-loans.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Create a countplot (bar plot showing counts using seaborn) that shows the counts of loans by purpose, with the color hue defined by <code>not.fully.paid</code></strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;purpose&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">loans</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;not.fully.paid&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[Text(0, 0, &#39;credit_card&#39;),
 Text(0, 0, &#39;all_other&#39;),
 Text(0, 0, &#39;debt_consolidation&#39;),
 Text(0, 0, &#39;home_improvement&#39;),
 Text(0, 0, &#39;major_purchase&#39;),
 Text(0, 0, &#39;small_business&#39;),
 Text(0, 0, &#39;educational&#39;)]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The countplot above shows the distribution of loans across different loan types by whether or not customers paid back their loans.<a rel="noopener" class="anchor-link" href="#The-countplot-above-shows-the-distribution-of-loans-across-different-loan-types-by-whether-or-not-customers-paid-back-their-loans.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let&#39;s see the trend between FICO score and interest rate. Recreate the following jointplot.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">loans</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fico&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;int.rate&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;seaborn.axisgrid.JointGrid at 0x7fc2ce261af0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># YOUR CODE</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Create the following lmplots to see if the trend differed between <code>not.fully.paid</code> and <code>credit.policy</code>. Check the documentation for seaborn <code>lmplot()</code> if you can&#39;t figure out how to separate it into columns.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;fico&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;int.rate&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;not.fully.paid&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;credit.policy&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">loans</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># YOUR CODE</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q3<a rel="noopener" class="anchor-link" href="#Q3">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Setting up the Data<a rel="noopener" class="anchor-link" href="#Setting-up-the-Data">&#182;</a></h2><p>Let&#39;s get ready to set up our data for our models!</p>
<p><strong>Check loans.info() again.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7478 entries, 0 to 7477
Data columns (total 14 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   credit.policy      7478 non-null   int64  
 1   purpose            7478 non-null   object 
 2   int.rate           7478 non-null   float64
 3   installment        7478 non-null   float64
 4   log.annual.inc     7478 non-null   float64
 5   dti                7478 non-null   float64
 6   fico               7478 non-null   int64  
 7   days.with.cr.line  7478 non-null   float64
 8   revol.bal          7478 non-null   int64  
 9   revol.util         7478 non-null   float64
 10  inq.last.6mths     7478 non-null   int64  
 11  delinq.2yrs        7478 non-null   int64  
 12  pub.rec            7478 non-null   int64  
 13  not.fully.paid     7478 non-null   int64  
dtypes: float64(6), int64(7), object(1)
memory usage: 818.0+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Categorical Features<a rel="noopener" class="anchor-link" href="#Categorical-Features">&#182;</a></h2><p>Notice that the <strong>purpose</strong> column is of categorical type.</p>
<p>That means we need to transform them using dummy variables so sklearn will be able to understand them. Let&#39;s do this in one clean step using pd.get_dummies().</p>
<p>Let&#39;s show you a way of dealing with these columns that can be expanded to multiple categorical features if necessary.</p>
<p><strong>Create a list of 1 element containing the string &#39;purpose&#39;. Call this list cat_feats.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cat_feats</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;purpose&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>The same transformation needs to be aplied on every dataset. The easiest way would be to merge train and test (loans_outcome_not_known) sets, and to split after the transformation.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loanTest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">loans_outcome_not_known</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">cat_feats</span><span class="p">)</span>
<span class="n">loanTest</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>credit.policy</th>
      <th>int.rate</th>
      <th>installment</th>
      <th>log.annual.inc</th>
      <th>dti</th>
      <th>fico</th>
      <th>days.with.cr.line</th>
      <th>revol.bal</th>
      <th>revol.util</th>
      <th>inq.last.6mths</th>
      <th>delinq.2yrs</th>
      <th>pub.rec</th>
      <th>purpose_all_other</th>
      <th>purpose_credit_card</th>
      <th>purpose_debt_consolidation</th>
      <th>purpose_educational</th>
      <th>purpose_home_improvement</th>
      <th>purpose_major_purchase</th>
      <th>purpose_small_business</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.1324</td>
      <td>540.96</td>
      <td>10.596635</td>
      <td>11.73</td>
      <td>672</td>
      <td>3210.000000</td>
      <td>5671</td>
      <td>55.1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0.1221</td>
      <td>333.15</td>
      <td>11.156193</td>
      <td>15.82</td>
      <td>707</td>
      <td>5314.000000</td>
      <td>107643</td>
      <td>81.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0.1218</td>
      <td>166.50</td>
      <td>10.753836</td>
      <td>6.38</td>
      <td>772</td>
      <td>1440.000000</td>
      <td>233</td>
      <td>6.7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0.1461</td>
      <td>124.12</td>
      <td>10.239960</td>
      <td>0.00</td>
      <td>692</td>
      <td>1530.041667</td>
      <td>0</td>
      <td>0.0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0.0800</td>
      <td>156.69</td>
      <td>10.434116</td>
      <td>15.85</td>
      <td>767</td>
      <td>10170.000000</td>
      <td>5748</td>
      <td>12.3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loanDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">loans</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_feats</span><span class="p">)</span>
<span class="n">loanDF</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>credit.policy</th>
      <th>int.rate</th>
      <th>installment</th>
      <th>log.annual.inc</th>
      <th>dti</th>
      <th>fico</th>
      <th>days.with.cr.line</th>
      <th>revol.bal</th>
      <th>revol.util</th>
      <th>inq.last.6mths</th>
      <th>delinq.2yrs</th>
      <th>pub.rec</th>
      <th>not.fully.paid</th>
      <th>purpose_all_other</th>
      <th>purpose_credit_card</th>
      <th>purpose_debt_consolidation</th>
      <th>purpose_educational</th>
      <th>purpose_home_improvement</th>
      <th>purpose_major_purchase</th>
      <th>purpose_small_business</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0800</td>
      <td>101.85</td>
      <td>10.596635</td>
      <td>10.26</td>
      <td>747</td>
      <td>7560.000000</td>
      <td>18467</td>
      <td>30.9</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.1114</td>
      <td>328.04</td>
      <td>10.530495</td>
      <td>14.13</td>
      <td>722</td>
      <td>1920.000000</td>
      <td>6811</td>
      <td>56.8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0.1324</td>
      <td>676.20</td>
      <td>11.289782</td>
      <td>20.73</td>
      <td>697</td>
      <td>4080.000000</td>
      <td>16805</td>
      <td>64.1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0.1103</td>
      <td>671.44</td>
      <td>10.555813</td>
      <td>15.72</td>
      <td>722</td>
      <td>3580.041667</td>
      <td>31566</td>
      <td>32.3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0.1545</td>
      <td>244.21</td>
      <td>10.308953</td>
      <td>18.80</td>
      <td>647</td>
      <td>1950.041667</td>
      <td>4587</td>
      <td>41.0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[282]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">loans_Unknown</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">loans_outcome_not_known</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_feats</span><span class="p">)</span>
<span class="n">loans_Unknown</span><span class="o">.</span><span class="n">head</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[282]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;bound method NDFrame.head of       credit.policy  int.rate  installment  log.annual.inc    dti  fico  \
0                 1    0.1324       540.96       10.596635  11.73   672   
1                 0    0.1221       333.15       11.156193  15.82   707   
2                 1    0.1218       166.50       10.753836   6.38   772   
3                 0    0.1461       124.12       10.239960   0.00   692   
4                 1    0.0800       156.69       10.434116  15.85   767   
...             ...       ...          ...             ...    ...   ...   
2095              1    0.1183        53.02       11.058795  12.26   712   
2096              1    0.1218       266.40       10.757903   2.32   762   
2097              1    0.1758       503.19       11.362103  21.93   662   
2098              1    0.1316       121.58       10.126631   9.79   697   
2099              1    0.0894       158.86       10.915016  20.14   727   

      days.with.cr.line  revol.bal  revol.util  inq.last.6mths  delinq.2yrs  \
0           3210.000000       5671        55.1               0            0   
1           5314.000000     107643        81.0               3            0   
2           1440.000000        233         6.7               0            0   
3           1530.041667          0         0.0               6            0   
4          10170.000000       5748        12.3               0            1   
...                 ...        ...         ...             ...          ...   
2095        3900.041667       3221        74.9               2            0   
2096        4474.000000       7470        38.3               1            0   
2097        3570.000000      18991        95.0               0            0   
2098        1680.000000       1898        34.5               3            0   
2099        6029.958333      22652        53.3               3            0   

      pub.rec  purpose_all_other  purpose_credit_card  \
0           0                  0                    0   
1           0                  0                    0   
2           0                  0                    0   
3           0                  0                    0   
4           0                  0                    1   
...       ...                ...                  ...   
2095        0                  0                    0   
2096        0                  0                    0   
2097        1                  0                    0   
2098        0                  0                    0   
2099        0                  1                    0   

      purpose_debt_consolidation  purpose_educational  \
0                              1                    0   
1                              0                    1   
2                              1                    0   
3                              0                    0   
4                              0                    0   
...                          ...                  ...   
2095                           1                    0   
2096                           0                    0   
2097                           1                    0   
2098                           0                    0   
2099                           0                    0   

      purpose_home_improvement  purpose_major_purchase  purpose_small_business  
0                            0                       0                       0  
1                            0                       0                       0  
2                            0                       0                       0  
3                            0                       1                       0  
4                            0                       0                       0  
...                        ...                     ...                     ...  
2095                         0                       0                       0  
2096                         0                       1                       0  
2097                         0                       0                       0  
2098                         0                       1                       0  
2099                         0                       0                       0  

[2100 rows x 19 columns]&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Now you can use <code>pd.get_dummies(loans,columns=cat_feats)</code> to create a fixed larger dataframe that has new feature columns with dummy variables.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Train Test Split<a rel="noopener" class="anchor-link" href="#Train-Test-Split">&#182;</a></h2><p>Now its time to split our data into a training set and a validation set!</p>
<p>The <code>not.fully.paid</code> variable is the one that we will try to predict.</p>
<p><strong>Use sklearn to split your data into a training set and a testing set as we&#39;ve done in the past.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">loanDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;not.fully.paid&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">loanDF</span><span class="p">[</span><span class="s1">&#39;not.fully.paid&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q4<a rel="noopener" class="anchor-link" href="#Q4">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Decision Tree Model<a rel="noopener" class="anchor-link" href="#Decision-Tree-Model">&#182;</a></h2><p>Let&#39;s start by training a single decision tree first!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Initiate the Decision Tree classifier from the sklearn library. Keep all parameters with their default values. (No need to specify anything)</li>
<li>Fit the model</li>
<li>Make predictions</li>
<li>Calculate accuracy score. What are the <strong>training</strong> and <strong>testing</strong> accuracies of the model?</li>
<li>Create confusion matrix</li>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Using all the training data perform cross-validation:<ul>
<li>Select the <code>min_samples_split</code> hyper-parameter and apply cross validation to find the best value.  </li>
<li>Select the <code>max_depth</code> hyper-parameter and apply cross validation to find the best value. </li>
<li>Perform grid search where you check for combinations of these hyper-parameters.<ul>
<li><a rel="noopener" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></li>
</ul>
</li>
</ul>
</li>
<li>For the best model:<ul>
<li>Plot the decision tree of the best model</li>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Compare the results to the model with default paramters. Any change?</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Import DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span><span class="p">,</span> <span class="n">plot_tree</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[33]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[35]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7058823529411765</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Accuracy for Decision Tree<a rel="noopener" class="anchor-link" href="#Accuracy-for-Decision-Tree">&#182;</a></h2><h3>Training Accuracy is 1.0<a rel="noopener" class="anchor-link" href="#Training-Accuracy-is-1.0">&#182;</a></h3><h3>Testing Accuracy is 0.71<a rel="noopener" class="anchor-link" href="#Testing-Accuracy-is-0.71">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1472,  335],
       [ 325,  112]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.2562929061784897</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.26. This can be found by dividing the number of true positives (112) by the true positives plus false negatives (112 + 325)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.26.-This-can-be-found-by-dividing-the-number-of-true-positives-(112)-by-the-true-positives-plus-false-negatives-(112-+-325)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8146098505810736</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 0.81, the specificity is found by dividing the true negatives (1472) by the sum of true negatives (1472) and false positives (335).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-0.81,-the-specificity-is-found-by-dividing-the-true-negatives-(1472)-by-the-sum-of-true-negatives-(1472)-and-false-positives-(335).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[39]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.2505592841163311</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 0.25. This can be found by dividing the true positives (112) by the true positives plus the false positives (112+335)<a rel="noopener" class="anchor-link" href="#The-precision-is-0.25.-This-can-be-found-by-dividing-the-true-positives-(112)-by-the-true-positives-plus-the-false-positives-(112+335)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[40]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5354513783797816</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Balanced Accuracy has a score of 0.53<a rel="noopener" class="anchor-link" href="#Balanced-Accuracy-has-a-score-of-0.53">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[41]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.253393665158371</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>F1 Score of 0.25<a rel="noopener" class="anchor-link" href="#F1-Score-of-0.25">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BEST PARAMS: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>

    <span class="n">means</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
    <span class="n">stds</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;std_test_score&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (+/-</span><span class="si">{}</span><span class="s1">) for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">params</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2}

0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9}
0.803 (+/-0.006) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10}
0.778 (+/-0.018) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2}
0.779 (+/-0.018) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3}
0.779 (+/-0.019) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4}
0.779 (+/-0.021) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5}
0.778 (+/-0.019) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6}
0.778 (+/-0.022) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7}
0.777 (+/-0.022) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8}
0.778 (+/-0.02) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9}
0.776 (+/-0.017) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10}
0.729 (+/-0.025) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2}
0.731 (+/-0.036) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3}
0.731 (+/-0.022) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4}
0.734 (+/-0.02) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5}
0.73 (+/-0.03) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6}
0.731 (+/-0.031) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7}
0.73 (+/-0.032) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8}
0.735 (+/-0.031) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9}
0.734 (+/-0.031) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10}
0.697 (+/-0.031) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2}
0.708 (+/-0.029) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3}
0.709 (+/-0.024) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4}
0.71 (+/-0.024) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5}
0.711 (+/-0.024) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6}
0.712 (+/-0.029) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7}
0.715 (+/-0.032) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8}
0.717 (+/-0.028) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9}
0.716 (+/-0.027) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The best parameters found are for a max depth of 1 and a min samples split of 2<a rel="noopener" class="anchor-link" href="#The-best-parameters-found-are-for-a-max-depth-of-1-and-a-min-samples-split-of-2">&#182;</a></h3><h3>Below we will fit the model with the aforementioned parameters and test the model for the relevant metrics<a rel="noopener" class="anchor-link" href="#Below-we-will-fit-the-model-with-the-aforementioned-parameters-and-test-the-model-for-the-relevant-metrics">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[46]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier(max_depth=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[48]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8097057699656095</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8052584670231729</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Accuracy for Decision Tree<a rel="noopener" class="anchor-link" href="#Accuracy-for-Decision-Tree">&#182;</a></h2><h3>Training Accuracy is 0.81<a rel="noopener" class="anchor-link" href="#Training-Accuracy-is-0.81">&#182;</a></h3><h3>Testing Accuracy is 0.81<a rel="noopener" class="anchor-link" href="#Testing-Accuracy-is-0.81">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[51]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1807,    0],
       [ 437,    0]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4>One interesting observation regarding the confusion matrix, is that there are no false positives or true positives everything falls into true negatives or false negatives<a rel="noopener" class="anchor-link" href="#One-interesting-observation-regarding-the-confusion-matrix,-is-that-there-are-no-false-positives-or-true-positives-everything-falls-into-true-negatives-or-false-negatives">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[52]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0, this is largely due to the absense of true positive values. This can be found by dividing the number of true positives (0) by the true positives plus false negatives (0) + (437)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0,-this-is-largely-due-to-the-absense-of-true-positive-values.-This-can-be-found-by-dividing-the-number-of-true-positives-(0)-by-the-true-positives-plus-false-negatives-(0)-+-(437)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[53]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 1, the specificity is found by dividing the true negatives (1807) by the sum of true negatives (1807) and false positives (0).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-1,-the-specificity-is-found-by-dividing-the-true-negatives-(1807)-by-the-sum-of-true-negatives-(1807)-and-false-positives-(0).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/danielobrien/opt/anaconda3/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[54]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>This returned a value of 0, although the actual answer cannot be computer because dividing by a zero cannot be computed. Therefore our result of having no true or false positives returns a strange result for precision.<a rel="noopener" class="anchor-link" href="#This-returned-a-value-of-0,-although-the-actual-answer-cannot-be-computer-because-dividing-by-a-zero-cannot-be-computed.-Therefore-our-result-of-having-no-true-or-false-positives-returns-a-strange-result-for-precision.">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[55]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Balanced Accuracy has a score of 0.50, this is slightly lower than the previous balances accuracy score.<a rel="noopener" class="anchor-link" href="#Balanced-Accuracy-has-a-score-of-0.50,-this-is-slightly-lower-than-the-previous-balances-accuracy-score.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[56]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>F1 Score of 0, this is likely due to the zeros in the true and false positive categories<a rel="noopener" class="anchor-link" href="#F1-Score-of-0,-this-is-likely-due-to-the-zeros-in-the-true-and-false-positive-categories">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>In summary, the tuning of the model returned an accuracy value which initially seemed better than the accuracy of the untuned model. However, after tuning this model, we ended up with no false positives and no false positives which gave us strange answers for some of our metrics and very poor metrics for a few categories.<a rel="noopener" class="anchor-link" href="#In-summary,-the-tuning-of-the-model-returned-an-accuracy-value-which-initially-seemed-better-than-the-accuracy-of-the-untuned-model.-However,-after-tuning-this-model,-we-ended-up-with-no-false-positives-and-no-false-positives-which-gave-us-strange-answers-for-some-of-our-metrics-and-very-poor-metrics-for-a-few-categories.">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q5<a rel="noopener" class="anchor-link" href="#Q5">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Random Forest model<a rel="noopener" class="anchor-link" href="#Random-Forest-model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Initiate the Random Forest classifier from the sklearn library. Keep all parameters with their default values. (No need to specify anything)</li>
<li>Fit the model</li>
<li>Make predictions</li>
<li>Calculate accuracy score. What are the <strong>training</strong> and <strong>testing</strong> accuracies of the model?</li>
<li>Create confusion matrix</li>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Using all the training data perform cross-validation:<ul>
<li>Select the <code>min_samples_split</code> hyper-parameter and apply cross validation to find the best value.  </li>
<li>Select the <code>max_depth</code> hyper-parameter and apply cross validation to find the best value. </li>
<li>Select the <code>n_estimators</code> hyper-parameter and apply cross validation to find the best value. </li>
<li>Perform grid search where you check for combinations of these hyper-parameters.<ul>
<li><a rel="noopener" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></li>
</ul>
</li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Compare the results to the model with default paramters. Any change?</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[59]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[61]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[63]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8092691622103387</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Initially, with all default values, the random forest classifier returned a training accuracy score of 1 and a testing accuracy score of 0.81<a rel="noopener" class="anchor-link" href="#Initially,-with-all-default-values,-the-random-forest-classifier-returned-a-training-accuracy-score-of-1-and-a-testing-accuracy-score-of-0.81">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[64]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1798,    9],
       [ 419,   18]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[65]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.041189931350114416</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.04. This can be found by dividing the number of true positives (18) by the true positives plus false negatives (18 + 419)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.04.-This-can-be-found-by-dividing-the-number-of-true-positives-(18)-by-the-true-positives-plus-false-negatives-(18-+-419)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[66]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9950193691200886</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 0.995, the specificity is found by dividing the true negatives (1798) by the sum of true negatives (1798) and false positives (9).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-0.995,-the-specificity-is-found-by-dividing-the-true-negatives-(1798)-by-the-sum-of-true-negatives-(1798)-and-false-positives-(9).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[67]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6666666666666666</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 0.67. This can be found by dividing the true positives (18) by the true positives plus the false positives (18+9)<a rel="noopener" class="anchor-link" href="#The-precision-is-0.67.-This-can-be-found-by-dividing-the-true-positives-(18)-by-the-true-positives-plus-the-false-positives-(18+9)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[68]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5181046502351015</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The balanced accuracy score is 0.52, this is lower than the other accuracy score.<a rel="noopener" class="anchor-link" href="#The-balanced-accuracy-score-is-0.52,-this-is-lower-than-the-other-accuracy-score.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[69]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.07758620689655173</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The F1 score is 0.08<a rel="noopener" class="anchor-link" href="#The-F1-score-is-0.08">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}

0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 2, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 5}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.809 (+/-0.003) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 20}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 20}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 5}
0.81 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 5}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 100}
0.81 (+/-0.003) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 10}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 5}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 10}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 100}
0.809 (+/-0.003) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 20}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 100}
0.809 (+/-0.003) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 5}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.809 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 4, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.803 (+/-0.012) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 5}
0.805 (+/-0.005) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 10}
0.811 (+/-0.005) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.81 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.802 (+/-0.009) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 5}
0.808 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 10}
0.807 (+/-0.008) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 20}
0.809 (+/-0.005) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.81 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.81 (+/-0.002) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.805 (+/-0.01) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 5}
0.806 (+/-0.009) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 10}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 20}
0.81 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 25}
0.808 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 50}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 75}
0.808 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 100}
0.804 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 5}
0.808 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 10}
0.808 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 20}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.81 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.804 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 5}
0.805 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 10}
0.808 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 20}
0.808 (+/-0.002) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 25}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 50}
0.809 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 75}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 100}
0.8 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 5}
0.806 (+/-0.005) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 10}
0.808 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 20}
0.81 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.809 (+/-0.002) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.81 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.801 (+/-0.013) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 5}
0.806 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 10}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 20}
0.807 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 25}
0.809 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 50}
0.809 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 75}
0.808 (+/-0.001) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 100}
0.799 (+/-0.015) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 5}
0.806 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 10}
0.807 (+/-0.005) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 20}
0.808 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 25}
0.808 (+/-0.001) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 75}
0.808 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 100}
0.801 (+/-0.01) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 5}
0.805 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 10}
0.807 (+/-0.006) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 20}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.809 (+/-0.004) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.808 (+/-0.003) for {&#39;max_depth&#39;: 8, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.787 (+/-0.016) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 5}
0.799 (+/-0.014) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 10}
0.804 (+/-0.004) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}
0.806 (+/-0.01) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.807 (+/-0.007) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.807 (+/-0.004) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.809 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.787 (+/-0.018) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 5}
0.801 (+/-0.013) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 10}
0.802 (+/-0.012) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 20}
0.803 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.806 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.806 (+/-0.004) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.806 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.785 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 5}
0.794 (+/-0.013) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 10}
0.804 (+/-0.007) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 20}
0.802 (+/-0.009) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 25}
0.805 (+/-0.007) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 50}
0.806 (+/-0.004) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 75}
0.806 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 100}
0.787 (+/-0.016) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 5}
0.797 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 10}
0.805 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 20}
0.803 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.804 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.808 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.807 (+/-0.007) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.79 (+/-0.016) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 5}
0.802 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 10}
0.801 (+/-0.011) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 20}
0.806 (+/-0.007) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 25}
0.809 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 50}
0.807 (+/-0.009) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 75}
0.808 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 100}
0.787 (+/-0.006) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 5}
0.799 (+/-0.011) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 10}
0.802 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 20}
0.806 (+/-0.004) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.805 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.808 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.807 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.781 (+/-0.016) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 5}
0.797 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 10}
0.805 (+/-0.01) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 20}
0.801 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 25}
0.805 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 50}
0.808 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 75}
0.807 (+/-0.003) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 100}
0.789 (+/-0.012) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 5}
0.8 (+/-0.01) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 10}
0.807 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 20}
0.804 (+/-0.009) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 25}
0.805 (+/-0.007) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 50}
0.807 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 75}
0.807 (+/-0.002) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 100}
0.786 (+/-0.014) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 5}
0.797 (+/-0.015) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 10}
0.806 (+/-0.009) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 20}
0.804 (+/-0.005) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.806 (+/-0.009) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.808 (+/-0.002) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.808 (+/-0.004) for {&#39;max_depth&#39;: 16, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.776 (+/-0.024) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 5}
0.798 (+/-0.012) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 10}
0.806 (+/-0.009) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 20}
0.804 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.808 (+/-0.004) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.806 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.807 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.769 (+/-0.01) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 5}
0.8 (+/-0.01) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 10}
0.805 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 20}
0.801 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.805 (+/-0.01) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.809 (+/-0.008) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.803 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.776 (+/-0.012) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 5}
0.794 (+/-0.011) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 10}
0.803 (+/-0.01) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 20}
0.806 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 25}
0.805 (+/-0.009) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 50}
0.806 (+/-0.004) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 75}
0.806 (+/-0.002) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 4, &#39;n_estimators&#39;: 100}
0.78 (+/-0.024) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 5}
0.799 (+/-0.008) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 10}
0.799 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 20}
0.805 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.809 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.808 (+/-0.004) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.807 (+/-0.002) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.78 (+/-0.012) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 5}
0.798 (+/-0.011) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 10}
0.801 (+/-0.011) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 20}
0.805 (+/-0.004) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 25}
0.805 (+/-0.003) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 50}
0.806 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 75}
0.806 (+/-0.002) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 6, &#39;n_estimators&#39;: 100}
0.783 (+/-0.024) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 5}
0.797 (+/-0.004) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 10}
0.804 (+/-0.009) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 20}
0.804 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.804 (+/-0.014) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.808 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.807 (+/-0.003) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.784 (+/-0.012) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 5}
0.795 (+/-0.003) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 10}
0.801 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 20}
0.802 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 25}
0.805 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 50}
0.807 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 75}
0.807 (+/-0.004) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 8, &#39;n_estimators&#39;: 100}
0.788 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 5}
0.794 (+/-0.011) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 10}
0.807 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 20}
0.806 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 25}
0.806 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 50}
0.806 (+/-0.007) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 75}
0.806 (+/-0.003) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 9, &#39;n_estimators&#39;: 100}
0.779 (+/-0.017) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 5}
0.797 (+/-0.003) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 10}
0.806 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 20}
0.807 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.806 (+/-0.006) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.805 (+/-0.008) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.809 (+/-0.005) for {&#39;max_depth&#39;: None, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>According to the grid search, the following parameters are the best to use:<a rel="noopener" class="anchor-link" href="#According-to-the-grid-search,-the-following-parameters-are-the-best-to-use:">&#182;</a></h3><h3>max_depth = 8<a rel="noopener" class="anchor-link" href="#max_depth-=-8">&#182;</a></h3><h3>min_samples_split = 2<a rel="noopener" class="anchor-link" href="#min_samples_split-=-2">&#182;</a></h3><h3>n_estimators = 20<a rel="noopener" class="anchor-link" href="#n_estimators-=-20">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[73]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(max_depth=8, n_estimators=20)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[75]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8293847917462743</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[77]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8052584670231729</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Accuracy:<a rel="noopener" class="anchor-link" href="#Accuracy:">&#182;</a></h3><h4>Training: 0.83<a rel="noopener" class="anchor-link" href="#Training:-0.83">&#182;</a></h4><h4>Testing: 0.81<a rel="noopener" class="anchor-link" href="#Testing:-0.81">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[78]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1801,    6],
       [ 431,    6]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[79]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.013729977116704805</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.014. This can be found by dividing the number of true positives (6) by the true positives plus false negatives (6 + 431)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.014.-This-can-be-found-by-dividing-the-number-of-true-positives-(6)-by-the-true-positives-plus-false-negatives-(6-+-431)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[80]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9966795794133924</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 0.997, the specificity is found by dividing the true negatives (1801) by the sum of true negatives (1801) and false positives (6).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-0.997,-the-specificity-is-found-by-dividing-the-true-negatives-(1801)-by-the-sum-of-true-negatives-(1801)-and-false-positives-(6).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[81]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 0.5. This can be found by dividing the true positives (6) by the true positives plus the false positives (6+6)<a rel="noopener" class="anchor-link" href="#The-precision-is-0.5.-This-can-be-found-by-dividing-the-true-positives-(6)-by-the-true-positives-plus-the-false-positives-(6+6)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[82]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5052047782650486</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The Balanced Accuracy Score for the tuned random forest is 0.51.<a rel="noopener" class="anchor-link" href="#The-Balanced-Accuracy-Score-for-the-tuned-random-forest-is-0.51.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[83]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.026726057906458798</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The F1 Score for the tuned random forest is 0.03.<a rel="noopener" class="anchor-link" href="#The-F1-Score-for-the-tuned-random-forest-is-0.03.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The F1 Score returned slightly lower from 0.06 to 0.03, both not a great score overall. The balanced accuracy score of 0.51 saw very little change from the balanced accuracy of the previous model at 0.52. Recall and Precision saw a very slight improvement, and specificity remained high for both models.<a rel="noopener" class="anchor-link" href="#The-F1-Score-returned-slightly-lower-from-0.06-to-0.03,-both-not-a-great-score-overall.-The-balanced-accuracy-score-of-0.51-saw-very-little-change-from-the-balanced-accuracy-of-the-previous-model-at-0.52.-Recall-and-Precision-saw-a-very-slight-improvement,-and-specificity-remained-high-for-both-models.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q6<a rel="noopener" class="anchor-link" href="#Q6">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Adaboost model<a rel="noopener" class="anchor-link" href="#Adaboost-model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Initiate the Random Forest classifier from the sklearn library. Keep all parameters with their default values. (No need to specify anything)</li>
<li>Fit the model</li>
<li>Make predictions</li>
<li>Calculate accuracy score. What are the <strong>training</strong> and <strong>testing</strong> accuracies of the model?</li>
<li>Create confusion matrix</li>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Using all the training data perform cross-validation:<ul>
<li>Select the <code>learning_rate</code> hyper-parameter and apply cross validation to find the best value.  </li>
<li>Select the <code>n_estimators</code> hyper-parameter and apply cross validation to find the best value. </li>
<li>Perform grid search where you check for combinations of these hyper-parameters.<ul>
<li><a rel="noopener" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></li>
</ul>
</li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Compare the results to the model with default paramters. Any change?</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[86]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[88]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.815246465418418</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[90]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.803475935828877</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The accuracy for the training model is 0.82 and the accuracy for the testing model is 0.80.<a rel="noopener" class="anchor-link" href="#The-accuracy-for-the-training-model-is-0.82-and-the-accuracy-for-the-testing-model-is-0.80.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[91]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1786,   21],
       [ 420,   17]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[92]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.038901601830663615</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.04. This can be found by dividing the number of true positives (17) by the true positives plus false negatives (17 + 420)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.04.-This-can-be-found-by-dividing-the-number-of-true-positives-(17)-by-the-true-positives-plus-false-negatives-(17-+-420)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[93]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9883785279468733</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 0.99, the specificity is found by dividing the true negatives (1786) by the sum of true negatives (1786) and false positives (21).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-0.99,-the-specificity-is-found-by-dividing-the-true-negatives-(1786)-by-the-sum-of-true-negatives-(1786)-and-false-positives-(21).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[94]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.4473684210526316</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 0.45. This can be found by dividing the true positives (17) by the true positives plus the false positives (17+21)<a rel="noopener" class="anchor-link" href="#The-precision-is-0.45.-This-can-be-found-by-dividing-the-true-positives-(17)-by-the-true-positives-plus-the-false-positives-(17+21)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[95]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5136400648887685</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The model returned a balanced accuracy of 0.51<a rel="noopener" class="anchor-link" href="#The-model-returned-a-balanced-accuracy-of-0.51">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[96]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.07157894736842106</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The model returned a F1 score of 0.07<a rel="noopener" class="anchor-link" href="#The-model-returned-a-F1-score-of-0.07">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 50}

0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 50}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 75}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 10}
0.809 (+/-0.004) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 20}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 25}
0.808 (+/-0.006) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 50}
0.807 (+/-0.006) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 75}
0.808 (+/-0.008) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 100}
0.808 (+/-0.004) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 5}
0.808 (+/-0.004) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 10}
0.807 (+/-0.005) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 20}
0.808 (+/-0.005) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 25}
0.807 (+/-0.006) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 50}
0.804 (+/-0.005) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 75}
0.804 (+/-0.004) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 100}
0.807 (+/-0.006) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 5}
0.807 (+/-0.006) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 10}
0.806 (+/-0.008) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 20}
0.806 (+/-0.007) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 25}
0.804 (+/-0.011) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 50}
0.804 (+/-0.004) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 75}
0.803 (+/-0.004) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 5}
0.536 (+/-0.501) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 10}
0.536 (+/-0.501) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 25}
0.645 (+/-0.374) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 75}
0.536 (+/-0.501) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 100}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Based on the results of the grid search, I will choose the parameters below:<a rel="noopener" class="anchor-link" href="#Based-on-the-results-of-the-grid-search,-I-will-choose-the-parameters-below:">&#182;</a></h3><h3>Learning Rate: 0.2<a rel="noopener" class="anchor-link" href="#Learning-Rate:-0.2">&#182;</a></h3><h3>Number of Estimators: 50<a rel="noopener" class="anchor-link" href="#Number-of-Estimators:-50">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[99]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[100]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier(learning_rate=0.2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[102]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[102]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8098968284294994</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[104]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8057040998217468</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The accuracy for the training model is 0.81 and the accuracy for the testing model is 0.81.<a rel="noopener" class="anchor-link" href="#The-accuracy-for-the-training-model-is-0.81-and-the-accuracy-for-the-testing-model-is-0.81.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[105]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1807,    0],
       [ 436,    1]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[106]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.002288329519450801</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.002. This can be found by dividing the number of true positives (1) by the true positives plus false negatives (1 + 436)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.002.-This-can-be-found-by-dividing-the-number-of-true-positives-(1)-by-the-true-positives-plus-false-negatives-(1-+-436)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[107]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 1, the specificity is found by dividing the true negatives (1807) by the sum of true negatives (1807) and false positives (0).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-1,-the-specificity-is-found-by-dividing-the-true-negatives-(1807)-by-the-sum-of-true-negatives-(1807)-and-false-positives-(0).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[108]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 1. This can be found by dividing the true positives (1) by the true positives plus the false positives (1+0)<a rel="noopener" class="anchor-link" href="#The-precision-is-1.-This-can-be-found-by-dividing-the-true-positives-(1)-by-the-true-positives-plus-the-false-positives-(1+0)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[109]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5011441647597255</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The balanced accuracy score is 0.5<a rel="noopener" class="anchor-link" href="#The-balanced-accuracy-score-is-0.5">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[110]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0045662100456621</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The F1 Score is 0.005<a rel="noopener" class="anchor-link" href="#The-F1-Score-is-0.005">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Similar to the results with the decision tree above, the tuning of this model returned a model with a very low number of True Positives (1) and no False Positives. This result returned some metrics really high and other metrics really low.<a rel="noopener" class="anchor-link" href="#Similar-to-the-results-with-the-decision-tree-above,-the-tuning-of-this-model-returned-a-model-with-a-very-low-number-of-True-Positives-(1)-and-no-False-Positives.-This-result-returned-some-metrics-really-high-and-other-metrics-really-low.">&#182;</a></h3><h3>The F1 score of the tuned model (0.005) was lower than the untuned model (0.07), although both were poor overall. There was not much change in the balanced accuracy score. The precision score (up to 1 from 0.45) was much higher, but this is misleading. The precision score increased so much because there was an absense of false positive values and only 1 true positive value.<a rel="noopener" class="anchor-link" href="#The-F1-score-of-the-tuned-model-(0.005)-was-lower-than-the-untuned-model-(0.07),-although-both-were-poor-overall.-There-was-not-much-change-in-the-balanced-accuracy-score.-The-precision-score-(up-to-1-from-0.45)-was-much-higher,-but-this-is-misleading.-The-precision-score-increased-so-much-because-there-was-an-absense-of-false-positive-values-and-only-1-true-positive-value.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q7<a rel="noopener" class="anchor-link" href="#Q7">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Gradient Boost model<a rel="noopener" class="anchor-link" href="#Gradient-Boost-model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Initiate the Random Forest classifier from the sklearn library. Keep all parameters with their default values. (No need to specify anything)</li>
<li>Fit the model</li>
<li>Make predictions</li>
<li>Calculate accuracy score. What are the <strong>training</strong> and <strong>testing</strong> accuracies of the model?</li>
<li>Create confusion matrix</li>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Using all the training data perform cross-validation:<ul>
<li>Select the <code>learning_rate</code> hyper-parameter and apply cross validation to find the best value.  </li>
<li>Select the <code>n_estimators</code> hyper-parameter and apply cross validation to find the best value. </li>
<li>Perform grid search where you check for combinations of these hyper-parameters.<ul>
<li><a rel="noopener" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></li>
</ul>
</li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
<li>Compare the results to the model with default paramters. Any change?</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[113]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[114]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[115]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingClassifier()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[116]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[117]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8291937332823844</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[120]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8057040998217468</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training accuracy score is 0.83 and the testing accuracy is 0.81<a rel="noopener" class="anchor-link" href="#The-training-accuracy-score-is-0.83-and-the-testing-accuracy-is-0.81">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[121]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1791,   16],
       [ 420,   17]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[122]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[122]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.038901601830663615</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.04. This can be found by dividing the number of true positives (17) by the true positives plus false negatives (17 + 420)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.04.-This-can-be-found-by-dividing-the-number-of-true-positives-(17)-by-the-true-positives-plus-false-negatives-(17-+-420)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[123]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[123]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9911455451023796</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 0.99, the specificity is found by dividing the true negatives (1791) by the sum of true negatives (1791) and false positives (16).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-0.99,-the-specificity-is-found-by-dividing-the-true-negatives-(1791)-by-the-sum-of-true-negatives-(1791)-and-false-positives-(16).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[124]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[124]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5151515151515151</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 0.52. This can be found by dividing the true positives (17) by the true positives plus the false positives (17+16)<a rel="noopener" class="anchor-link" href="#The-precision-is-0.52.-This-can-be-found-by-dividing-the-true-positives-(17)-by-the-true-positives-plus-the-false-positives-(17+16)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[125]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[125]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5150235734665216</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The Balanced Accuracy Score for this model is 0.52<a rel="noopener" class="anchor-link" href="#The-Balanced-Accuracy-Score-for-this-model-is-0.52">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[126]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0723404255319149</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The F1 Score is 0.07<a rel="noopener" class="anchor-link" href="#The-F1-Score-is-0.07">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[128]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 25}

0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 50}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 75}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.01, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 25}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 50}
0.809 (+/-0.002) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 75}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.02, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 20}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 25}
0.81 (+/-0.002) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 50}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 75}
0.808 (+/-0.005) for {&#39;learning_rate&#39;: 0.05, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 10}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 20}
0.81 (+/-0.002) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 25}
0.808 (+/-0.004) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 50}
0.806 (+/-0.007) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 75}
0.808 (+/-0.007) for {&#39;learning_rate&#39;: 0.08, &#39;n_estimators&#39;: 100}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 5}
0.81 (+/-0.001) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 10}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 20}
0.81 (+/-0.002) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 25}
0.807 (+/-0.006) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 50}
0.808 (+/-0.004) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 75}
0.807 (+/-0.003) for {&#39;learning_rate&#39;: 0.1, &#39;n_estimators&#39;: 100}
0.81 (+/-0.003) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 5}
0.81 (+/-0.006) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 10}
0.808 (+/-0.006) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 20}
0.809 (+/-0.003) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 25}
0.806 (+/-0.008) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 50}
0.805 (+/-0.005) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 75}
0.802 (+/-0.004) for {&#39;learning_rate&#39;: 0.2, &#39;n_estimators&#39;: 100}
0.804 (+/-0.007) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 5}
0.8 (+/-0.008) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 10}
0.797 (+/-0.006) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 20}
0.797 (+/-0.005) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 25}
0.787 (+/-0.008) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 50}
0.777 (+/-0.005) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 75}
0.773 (+/-0.008) for {&#39;learning_rate&#39;: 0.5, &#39;n_estimators&#39;: 100}
0.802 (+/-0.009) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 5}
0.796 (+/-0.016) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 10}
0.788 (+/-0.017) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 20}
0.781 (+/-0.017) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 25}
0.778 (+/-0.015) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 50}
0.771 (+/-0.02) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 75}
0.766 (+/-0.016) for {&#39;learning_rate&#39;: 0.8, &#39;n_estimators&#39;: 100}
0.805 (+/-0.012) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 5}
0.795 (+/-0.008) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 10}
0.786 (+/-0.011) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 20}
0.782 (+/-0.014) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 25}
0.759 (+/-0.019) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 50}
0.753 (+/-0.013) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 75}
0.746 (+/-0.021) for {&#39;learning_rate&#39;: 1, &#39;n_estimators&#39;: 100}
0.76 (+/-0.029) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 5}
0.733 (+/-0.034) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 10}
0.716 (+/-0.106) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 20}
0.682 (+/-0.199) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 25}
0.611 (+/-0.403) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 50}
0.611 (+/-0.403) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 75}
0.611 (+/-0.403) for {&#39;learning_rate&#39;: 2, &#39;n_estimators&#39;: 100}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The parameters chosen for the Gradient Boost Classifier are as follows:<a rel="noopener" class="anchor-link" href="#The-parameters-chosen-for-the-Gradient-Boost-Classifier-are-as-follows:">&#182;</a></h3><h3>Learning Rate: 0.08<a rel="noopener" class="anchor-link" href="#Learning-Rate:-0.08">&#182;</a></h3><h3>Number of Estimators: 25<a rel="noopener" class="anchor-link" href="#Number-of-Estimators:-25">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[129]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[130]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[130]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingClassifier(learning_rate=0.08, n_estimators=25)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[131]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[132]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[132]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8121895299961789</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[133]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[134]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[134]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8057040998217468</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The accuracy for the training set is 0.81 and the accuracy for the testing set is 0.81<a rel="noopener" class="anchor-link" href="#The-accuracy-for-the-training-set-is-0.81-and-the-accuracy-for-the-testing-set-is-0.81">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[135]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[135]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1805,    2],
       [ 434,    3]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[136]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[136]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.006864988558352402</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Recall<a rel="noopener" class="anchor-link" href="#Recall">&#182;</a></h3><h4>TP/(TP + FN)<a rel="noopener" class="anchor-link" href="#TP/(TP-+-FN)">&#182;</a></h4><h4>The Recall value is 0.007. This can be found by dividing the number of true positives (3) by the true positives plus false negatives (3 + 434)<a rel="noopener" class="anchor-link" href="#The-Recall-value-is-0.007.-This-can-be-found-by-dividing-the-number-of-true-positives-(3)-by-the-true-positives-plus-false-negatives-(3-+-434)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[137]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[137]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9988931931377975</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Specificity<a rel="noopener" class="anchor-link" href="#Specificity">&#182;</a></h3><h4>The Specificity is 0.999, the specificity is found by dividing the true negatives (1805) by the sum of true negatives (1805) and false positives (2).<a rel="noopener" class="anchor-link" href="#The-Specificity-is-0.999,-the-specificity-is-found-by-dividing-the-true-negatives-(1805)-by-the-sum-of-true-negatives-(1805)-and-false-positives-(2).">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[138]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[138]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Precision<a rel="noopener" class="anchor-link" href="#Precision">&#182;</a></h3><h4>TP/(TP+FP)<a rel="noopener" class="anchor-link" href="#TP/(TP+FP)">&#182;</a></h4><h4>The precision is 0.6. This can be found by dividing the true positives (3) by the true positives plus the false positives (3+2)<a rel="noopener" class="anchor-link" href="#The-precision-is-0.6.-This-can-be-found-by-dividing-the-true-positives-(3)-by-the-true-positives-plus-the-false-positives-(3+2)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[139]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[139]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5028790908480749</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The balanced accuracy is 0.5<a rel="noopener" class="anchor-link" href="#The-balanced-accuracy-is-0.5">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[140]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[140]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.013574660633484162</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The F1 Score is 0.14<a rel="noopener" class="anchor-link" href="#The-F1-Score-is-0.14">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>After tuning the model, most metric declined slightly. There was a slight improvement in both Specificity and Precision.<a rel="noopener" class="anchor-link" href="#After-tuning-the-model,-most-metric-declined-slightly.-There-was-a-slight-improvement-in-both-Specificity-and-Precision.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q8<a rel="noopener" class="anchor-link" href="#Q8">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Using the Decision Tree, Random Forest, Adaboost, and Gradient Boosting classifer models:<ul>
<li>Think of other ways of improving the accuracy and list at least two possibilities.</li>
<li>Implement both of the methods you proposed. </li>
<li>Is the model recall increasing? Why do you think this might have helped?</li>
<li>If both of them did not improve, comment on why this might have been the case.</li>
<li>Optional: Apply different things and see if the recall is improving</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Decision Tree<a rel="noopener" class="anchor-link" href="#Decision-Tree">&#182;</a></h2><h3>Since I got strange results after tuning the model, I will use my default parameters of the decision tree as a starting point. The two methods I will try to see if I can get better results are adjusting the ccp_alpha value and I will try adjusting the criterion to include entropy to see if there is any improvement.<a rel="noopener" class="anchor-link" href="#Since-I-got-strange-results-after-tuning-the-model,-I-will-use-my-default-parameters-of-the-decision-tree-as-a-starting-point.-The-two-methods-I-will-try-to-see-if-I-can-get-better-results-are-adjusting-the-ccp_alpha-value-and-I-will-try-adjusting-the-criterion-to-include-entropy-to-see-if-there-is-any-improvement.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[141]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[142]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">],</span>
    <span class="s1">&#39;ccp_alpha&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[143]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;ccp_alpha&#39;: 0.01, &#39;criterion&#39;: &#39;gini&#39;}

0.702 (+/-0.02) for {&#39;ccp_alpha&#39;: 0, &#39;criterion&#39;: &#39;gini&#39;}
0.705 (+/-0.014) for {&#39;ccp_alpha&#39;: 0, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.01, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.01, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.02, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.02, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.05, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.05, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.07, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.07, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.1, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.1, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.2, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.2, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.5, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.5, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.8, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 0.8, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 1, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 1, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 2, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 2, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 5, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 5, &#39;criterion&#39;: &#39;entropy&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 10, &#39;criterion&#39;: &#39;gini&#39;}
0.81 (+/-0.001) for {&#39;ccp_alpha&#39;: 10, &#39;criterion&#39;: &#39;entropy&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>It appears, based on the grid search above, that Gini index will continue to be the best criterion and a ccp_alpha value of 0.01 will return the highest score.<a rel="noopener" class="anchor-link" href="#It-appears,-based-on-the-grid-search-above,-that-Gini-index-will-continue-to-be-the-best-criterion-and-a-ccp_alpha-value-of-0.01-will-return-the-highest-score.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[144]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">ccp_alpha</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[145]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[145]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier(ccp_alpha=0.01)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[146]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[147]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[147]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8097057699656095</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[148]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[149]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[149]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8052584670231729</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The original accuracy for decision trees is 1 for training and 0.71 for testing. This tuning showed improvement by bringing down the training accuracy but increasing the testing accuracy. After tuning the training accuracy is 0.81 and the testing accuracy is 0.81<a rel="noopener" class="anchor-link" href="#The-original-accuracy-for-decision-trees-is-1-for-training-and-0.71-for-testing.-This-tuning-showed-improvement-by-bringing-down-the-training-accuracy-but-increasing-the-testing-accuracy.-After-tuning-the-training-accuracy-is-0.81-and-the-testing-accuracy-is-0.81">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[150]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[150]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1807,    0],
       [ 437,    0]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[151]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[151]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Similar to what was seen before when tuning the decision tree model, the model classified no true or false positives. This results in the recall score being 0.<a rel="noopener" class="anchor-link" href="#Similar-to-what-was-seen-before-when-tuning-the-decision-tree-model,-the-model-classified-no-true-or-false-positives.-This-results-in-the-recall-score-being-0.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Random Forest<a rel="noopener" class="anchor-link" href="#Random-Forest">&#182;</a></h2><h3>For Random Forest, I will keep the optimal parameters found in the earlier pruning while also changing the max_features setting and the min_samples_leaf to see if this model can return a better result<a rel="noopener" class="anchor-link" href="#For-Random-Forest,-I-will-keep-the-optimal-parameters-found-in-the-earlier-pruning-while-also-changing-the-max_features-setting-and-the-min_samples_leaf-to-see-if-this-model-can-return-a-better-result">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[155]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[156]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 8}

0.809 (+/-0.002) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 1}
0.809 (+/-0.005) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 2}
0.808 (+/-0.004) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 3}
0.808 (+/-0.003) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 4}
0.808 (+/-0.004) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 5}
0.81 (+/-0.002) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 6}
0.809 (+/-0.004) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 7}
0.809 (+/-0.003) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 8}
0.809 (+/-0.004) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 9}
0.81 (+/-0.002) for {&#39;max_features&#39;: &#39;auto&#39;, &#39;min_samples_leaf&#39;: 10}
0.808 (+/-0.002) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 1}
0.808 (+/-0.006) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 2}
0.81 (+/-0.003) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 3}
0.808 (+/-0.002) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 4}
0.809 (+/-0.002) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 5}
0.807 (+/-0.004) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 6}
0.81 (+/-0.001) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 7}
0.809 (+/-0.003) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 8}
0.81 (+/-0.003) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 9}
0.809 (+/-0.002) for {&#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_leaf&#39;: 10}
0.81 (+/-0.007) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 1}
0.809 (+/-0.004) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 2}
0.808 (+/-0.004) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 3}
0.809 (+/-0.004) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 4}
0.808 (+/-0.004) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 5}
0.808 (+/-0.003) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 6}
0.809 (+/-0.004) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 7}
0.811 (+/-0.001) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 8}
0.809 (+/-0.003) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 9}
0.81 (+/-0.004) for {&#39;max_features&#39;: &#39;log2&#39;, &#39;min_samples_leaf&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The optimal parameters are found below:<a rel="noopener" class="anchor-link" href="#The-optimal-parameters-are-found-below:">&#182;</a></h3><h4>max_features: log2<a rel="noopener" class="anchor-link" href="#max_features:-log2">&#182;</a></h4><h4>min_samples_leaf: 8<a rel="noopener" class="anchor-link" href="#min_samples_leaf:-8">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[157]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">max_features</span> <span class="o">=</span> <span class="s1">&#39;log2&#39;</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[158]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[158]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(max_depth=8, max_features=&#39;log2&#39;, min_samples_leaf=8,
                       n_estimators=20)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[159]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[160]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[160]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8148643484906382</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[161]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[162]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[162]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8070409982174688</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training accuracy is 0.815 and the testing accuracy is 0.807. The training accuracy had a slight dip and the testing accuracy had a very slight increase from 0.805 to 0.807<a rel="noopener" class="anchor-link" href="#The-training-accuracy-is-0.815-and-the-testing-accuracy-is-0.807.-The-training-accuracy-had-a-slight-dip-and-the-testing-accuracy-had-a-very-slight-increase-from-0.805-to-0.807">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[163]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[163]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1806,    1],
       [ 432,    5]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[164]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[164]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.011441647597254004</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The Recall score returned at 0.011, this is a very slight dip from the previous random forest recall of 0.0137.<a rel="noopener" class="anchor-link" href="#The-Recall-score-returned-at-0.011,-this-is-a-very-slight-dip-from-the-previous-random-forest-recall-of-0.0137.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Adaboost Classifier<a rel="noopener" class="anchor-link" href="#Adaboost-Classifier">&#182;</a></h2><h3>The two modification I will make to the Adaboost Classifier is to change the algorithm from the default algorithm and try different random states.<a rel="noopener" class="anchor-link" href="#The-two-modification-I-will-make-to-the-Adaboost-Classifier-is-to-change-the-algorithm-from-the-default-algorithm-and-try-different-random-states.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[165]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SAMME&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMME.R&#39;</span><span class="p">],</span>
    <span class="s1">&#39;random_state&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1031</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[167]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 1}

0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 1}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 2}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 3}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 4}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 5}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 6}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 7}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 8}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 9}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 10}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 50}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME&#39;, &#39;random_state&#39;: 1031}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 1}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 2}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 3}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 4}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 5}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 6}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 7}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 8}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 9}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 10}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 50}
0.81 (+/-0.001) for {&#39;algorithm&#39;: &#39;SAMME.R&#39;, &#39;random_state&#39;: 1031}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[174]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;SAMME&#39;</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[175]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[175]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier(algorithm=&#39;SAMME&#39;, learning_rate=0.2, random_state=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[176]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[177]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[177]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8097057699656095</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[178]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[179]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[179]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8052584670231729</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training accuracy score is 0.8097 and the testing accuracy is 0.8052, there is a very slight dip previous accuracy scores<a rel="noopener" class="anchor-link" href="#The-training-accuracy-score-is-0.8097-and-the-testing-accuracy-is-0.8052,-there-is-a-very-slight-dip-previous-accuracy-scores">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[180]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[180]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1807,    0],
       [ 437,    0]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[181]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[181]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The recall score is 0, this is due to the absence of true and false positive classifications. Which is slightly worse than the previous recall score because there was 1 true positive value<a rel="noopener" class="anchor-link" href="#The-recall-score-is-0,-this-is-due-to-the-absence-of-true-and-false-positive-classifications.-Which-is-slightly-worse-than-the-previous-recall-score-because-there-was-1-true-positive-value">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Gradient Boost<a rel="noopener" class="anchor-link" href="#Gradient-Boost">&#182;</a></h2><h3>We will adjust the criterion and the minimum samples split to see if we can improve our gradient boost classifier<a rel="noopener" class="anchor-link" href="#We-will-adjust-the-criterion-and-the-minimum-samples-split-to-see-if-we-can-improve-our-gradient-boost-classifier">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[198]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[188]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;friedman_mse&#39;</span><span class="p">,</span> <span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_split&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[189]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 3}

0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 2}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 3}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 4}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 5}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 6}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 7}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 8}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 9}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;min_samples_split&#39;: 10}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 2}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 3}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 4}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 5}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 6}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 7}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 8}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 9}
0.81 (+/-0.002) for {&#39;criterion&#39;: &#39;mse&#39;, &#39;min_samples_split&#39;: 10}
0.807 (+/-0.006) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 2}
0.807 (+/-0.006) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 3}
0.807 (+/-0.006) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 4}
0.807 (+/-0.006) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 5}
0.806 (+/-0.005) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 6}
0.806 (+/-0.005) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 7}
0.806 (+/-0.005) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 8}
0.807 (+/-0.005) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 9}
0.807 (+/-0.005) for {&#39;criterion&#39;: &#39;mae&#39;, &#39;min_samples_split&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[190]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">criterion</span> <span class="o">=</span><span class="s1">&#39;friedman_mse&#39;</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[191]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[191]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingClassifier(learning_rate=0.08, min_samples_split=3,
                           n_estimators=25)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[193]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8121895299961789</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[195]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[195]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8057040998217468</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training accuracy score is 0.812 and the testing accuracy is 0.806, there is a very slight dip previous accuracy scores<a rel="noopener" class="anchor-link" href="#The-training-accuracy-score-is-0.812-and-the-testing-accuracy-is-0.806,-there-is-a-very-slight-dip-previous-accuracy-scores">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[196]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[196]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1805,    2],
       [ 434,    3]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[197]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.006864988558352402</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The recall score is 0.0069.<a rel="noopener" class="anchor-link" href="#The-recall-score-is-0.0069.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q9<a rel="noopener" class="anchor-link" href="#Q9">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Choose the best fitted model for each of teh classifiers (1 model for each of Decision Tree, Random Forest, Adaboost, and Gradient Boosting)</li>
<li>Create a table summarizing results on the test set:<ul>
<li>Create confusion matrix for each model</li>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the testing set:<ul>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Decision Tree<a rel="noopener" class="anchor-link" href="#Decision-Tree">&#182;</a></h2><h3>When I tuned the decision tree model, I ended up with strange results where there were no false or true positive values, so I will use the default parameters for my final decision tree model.<a rel="noopener" class="anchor-link" href="#When-I-tuned-the-decision-tree-model,-I-ended-up-with-strange-results-where-there-were-no-false-or-true-positive-values,-so-I-will-use-the-default-parameters-for-my-final-decision-tree-model.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[200]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[201]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">DT</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[201]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">DT</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[203]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[203]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[204]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">DT</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[205]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[205]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7018716577540107</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[206]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[206]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1466,  341],
       [ 328,  109]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[207]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[207]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.2494279176201373</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[208]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[208]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.811289429994466</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[209]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[209]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.24222222222222223</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[210]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5303586738073016</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[211]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[211]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.245772266065389</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Random Forest<a rel="noopener" class="anchor-link" href="#Random-Forest">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[212]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">RF</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">max_features</span> <span class="o">=</span> <span class="s1">&#39;log2&#39;</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[213]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">RF</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[213]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(max_depth=8, max_features=&#39;log2&#39;, min_samples_leaf=8,
                       n_estimators=20)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[214]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">RF</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[215]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[215]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8169659915934276</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[217]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">RF</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[218]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[218]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8061497326203209</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[219]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[219]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1804,    3],
       [ 432,    5]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[220]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[220]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.011441647597254004</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[221]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[221]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9983397897066962</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[222]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[222]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.625</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[223]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[223]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5048907186519751</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[224]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[224]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.02247191011235955</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Adaboost Classifier<a rel="noopener" class="anchor-link" href="#Adaboost-Classifier">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[225]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">AB</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[226]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">AB</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[226]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier(learning_rate=0.2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[227]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">AB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[228]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[228]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8098968284294994</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[229]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">AB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[230]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[230]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8057040998217468</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[231]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[231]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1807,    0],
       [ 436,    1]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[232]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[232]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.002288329519450801</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[233]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[233]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[234]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[234]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[235]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[235]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5011441647597255</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[236]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[236]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0045662100456621</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Gradient Boosting<a rel="noopener" class="anchor-link" href="#Gradient-Boosting">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[237]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">GB</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">criterion</span> <span class="o">=</span><span class="s1">&#39;friedman_mse&#39;</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[238]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">GB</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[238]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingClassifier(learning_rate=0.08, min_samples_split=3,
                           n_estimators=25)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[239]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">GB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[240]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTrain</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[240]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8121895299961789</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[241]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTest</span> <span class="o">=</span> <span class="n">GB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[242]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[242]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8057040998217468</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[243]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[243]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1805,    2],
       [ 434,    3]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[244]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[244]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.006864988558352402</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[245]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[245]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9988931931377975</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[246]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[246]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[247]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[247]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5028790908480749</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[271]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predTest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[271]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.013574660633484162</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[272]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;Decision Tree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.71</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> 
          <span class="s1">&#39;Random Forest&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.998</span><span class="p">,</span> <span class="mf">0.625</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">],</span> 
          <span class="s1">&#39;Adaboost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">],</span> 
          <span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.014</span><span class="p">]})</span>

<span class="c1">#index:[&#39;Testing Accuracy&#39;, &#39;Recall&#39;, &#39;Specificity&#39;, &#39;Precision&#39;, &#39;Balanced Accuracy&#39;, &#39;F1&#39;]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[276]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Testing Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;Specificity&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Balanced Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[276]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Testing Accuracy</th>
      <th>Recall</th>
      <th>Specificity</th>
      <th>Precision</th>
      <th>Balanced Accuracy</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Decision Tree</th>
      <td>0.71</td>
      <td>0.250</td>
      <td>0.810</td>
      <td>0.240</td>
      <td>0.53</td>
      <td>0.250</td>
    </tr>
    <tr>
      <th>Random Forest</th>
      <td>0.81</td>
      <td>0.010</td>
      <td>0.998</td>
      <td>0.625</td>
      <td>0.50</td>
      <td>0.020</td>
    </tr>
    <tr>
      <th>Adaboost</th>
      <td>0.81</td>
      <td>0.002</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.50</td>
      <td>0.005</td>
    </tr>
    <tr>
      <th>Gradient Boosting</th>
      <td>0.81</td>
      <td>0.007</td>
      <td>0.999</td>
      <td>0.600</td>
      <td>0.50</td>
      <td>0.014</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Q10<a rel="noopener" class="anchor-link" href="#Q10">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Choose a winner model.</li>
<li>Make predictions on the hold-out set whose outcome variables are not known (data we imported as: <code>loans_outcome_not_known</code>).</li>
<li>Write the code below to make predictions with this model. At the end it should output the prediction of the labels.</li>
<li>Save the predictions in a csv file</li>
<li>There should be a single column in the csv file.</li>
<li>The column header should be &#39;predictions&#39;</li>
<li>Your prediction performance will be calculated and a ranking will be performed </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>I will choose my random forest as a winner because it is among the highest in terms of accuracy and balanced accuracy and the other statistics are more balanced than some of the other models.<a rel="noopener" class="anchor-link" href="#I-will-choose-my-random-forest-as-a-winner-because-it-is-among-the-highest-in-terms-of-accuracy-and-balanced-accuracy-and-the-other-statistics-are-more-balanced-than-some-of-the-other-models.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[277]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">RF</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">max_features</span> <span class="o">=</span> <span class="s1">&#39;log2&#39;</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[278]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">RF</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[278]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(max_depth=8, max_features=&#39;log2&#39;, min_samples_leaf=8,
                       n_estimators=20)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[279]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predTrain</span> <span class="o">=</span> <span class="n">RF</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[284]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Predictions</span> <span class="o">=</span> <span class="n">RF</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">loans_Unknown</span><span class="p">)</span>
<span class="n">Predictions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[284]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0, 0, 0, ..., 0, 0, 0])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[286]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">FinalPred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Predictions</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[288]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">FinalPred</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;predictions.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Great Job!<a rel="noopener" class="anchor-link" href="#Great-Job!">&#182;</a></h1>
</div>
</div>
</div>
    </div>
  </div>


 



<script type="text/javascript" src="/d2l/common/math/MathML.js?v=20.21.12.34125 "></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() { D2LMathML.DesktopInit('https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=MML_HTMLorMML','https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML','130',false); });</script></body></html>