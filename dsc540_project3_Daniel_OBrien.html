<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>



Assignment 3

















    
    
    
    

  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>DSC540 Project 3<a rel="noopener" class="anchor-link" href="#DSC540-Project-3">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>DePaul University<br/>
Ilyas Ustun, PhD<br/>
Chicago, IL</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Rules<a rel="noopener" class="anchor-link" href="#Rules">&#182;</a></h2><ul>
<li>Do not change the code already present in the notebook.</li>
<li>Write your code under the corresponding questions where you see <code># Code here</code>. You are encouraged to use more than one cell.</li>
<li>Provide explanation in a separate Markdown formatted cell. </li>
<li>You can change the cell type by:<ul>
<li>Clicking on the outer area of the cell type you want to change,</li>
<li>Go to the top, and select either Code or Markdown from the dropdown menu.</li>
</ul>
</li>
<li>Be concise in your explanations and conclusions.</li>
<li>Write clear code and provide explanation to functions you create by using <code>#</code> comment sign.</li>
<li>For built-in function and methods you use from libraries, provide a very brief explanation of what they do.</li>
<li>Try to answer the questions by yourself. Use documentation from pandas, sklearn and similar libraries to solve the problem.</li>
<li>If you are stuck you can use different resources. Do not find an identical project and copy paste the solutions. </li>
<li>Write your name before beginning to code.</li>
</ul>
<p>Important:</p>
<ul>
<li><strong>Do NOT share the solutions with other people.</strong></li>
<li><strong>Do NOT share the solutions on the internet including but not limited to Github and other platforms.</strong></li>
<li>Sign the Honor Pledge below indicating that you have agreed to these rules listed here, and any other ethical and honor rules as required by the university.</li>
</ul>
<ul>
<li><strong>Deliverables:</strong><ol>
<li>The Python Jupyter notebook file named properly with your name. Example: dsc540_project1_john_doe.ipynb</li>
<li>The HTML output of this code notebook names the same way. Example: dsc540_project1_john_doe.html<ul>
<li>File -&gt; Download as -&gt; HTML   </li>
</ul>
</li>
</ol>
</li>
</ul>
<p>Good Luck!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Daniel O&#39;Brien<a rel="noopener" class="anchor-link" href="#Daniel-O&#39;Brien">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Honor Pledge:</strong><br/>
I pledge on my honor that I, <strong>Daniel O&#39;Brien</strong>, have followed the rules listed above, that I have not given or received any unauthorized assistance on this assignment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Project Description<a rel="noopener" class="anchor-link" href="#Project-Description">&#182;</a></h2><p>In this project we will be analyzing CO and NOX gas emissions from a power plant. The variables, their meanings and some statistics are given in the table below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="PowerPlantEmissionsFeaturesTable.PNG" alt="PowerPlantEmissionsFeaturesTable"/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Import Libraries<a rel="noopener" class="anchor-link" href="#Import-Libraries">&#182;</a></h2><p><strong>Import the usual libraries for pandas and plotting, and sklearn.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn</span>
<span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;0.23.1&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>These are the packages I used<a rel="noopener" class="anchor-link" href="#These-are-the-packages-I-used">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q1 [10]<a rel="noopener" class="anchor-link" href="#Q1-[10]">&#182;</a></h2><ul>
<li>Read in the dataset</li>
<li>How many rows and variables are there?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Get the Data<a rel="noopener" class="anchor-link" href="#Get-the-Data">&#182;</a></h2><p><strong>Use pandas to read in the datasets as a dataframe.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;gas_emissions.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>AFDP</th>
      <th>GTEP</th>
      <th>TIT</th>
      <th>TAT</th>
      <th>TEY</th>
      <th>CDP</th>
      <th>CO</th>
      <th>NOX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.95320</td>
      <td>1020.1</td>
      <td>84.985</td>
      <td>2.5304</td>
      <td>20.116</td>
      <td>1048.7</td>
      <td>544.92</td>
      <td>116.27</td>
      <td>10.799</td>
      <td>7.4491</td>
      <td>113.250</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.21910</td>
      <td>1020.1</td>
      <td>87.523</td>
      <td>2.3937</td>
      <td>18.584</td>
      <td>1045.5</td>
      <td>548.50</td>
      <td>109.18</td>
      <td>10.347</td>
      <td>6.4684</td>
      <td>112.020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.94915</td>
      <td>1022.2</td>
      <td>78.335</td>
      <td>2.7789</td>
      <td>22.264</td>
      <td>1068.8</td>
      <td>549.95</td>
      <td>125.88</td>
      <td>11.256</td>
      <td>3.6335</td>
      <td>88.147</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.00750</td>
      <td>1021.7</td>
      <td>76.942</td>
      <td>2.8170</td>
      <td>23.358</td>
      <td>1075.2</td>
      <td>549.63</td>
      <td>132.21</td>
      <td>11.702</td>
      <td>3.1972</td>
      <td>87.078</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.28580</td>
      <td>1021.6</td>
      <td>76.732</td>
      <td>2.8377</td>
      <td>23.483</td>
      <td>1076.2</td>
      <td>549.68</td>
      <td>133.58</td>
      <td>11.737</td>
      <td>2.3833</td>
      <td>82.515</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(7384, 11)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>There are 7,384 rows and 11 columns. Because each column represents a variable, there are 11 variables.<a rel="noopener" class="anchor-link" href="#There-are-7,384-rows-and-11-columns.-Because-each-column-represents-a-variable,-there-are-11-variables.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4>What is the average value of AP for those points who have CO levels above 3 $mg/m^3$?<a rel="noopener" class="anchor-link" href="#What-is-the-average-value-of-AP-for-those-points-who-have-CO-levels-above-3-$mg/m^3$?">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">CO</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>AFDP</th>
      <th>GTEP</th>
      <th>TIT</th>
      <th>TAT</th>
      <th>TEY</th>
      <th>CDP</th>
      <th>CO</th>
      <th>NOX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.95320</td>
      <td>1020.1</td>
      <td>84.985</td>
      <td>2.5304</td>
      <td>20.116</td>
      <td>1048.7</td>
      <td>544.92</td>
      <td>116.27</td>
      <td>10.799</td>
      <td>7.4491</td>
      <td>113.250</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.21910</td>
      <td>1020.1</td>
      <td>87.523</td>
      <td>2.3937</td>
      <td>18.584</td>
      <td>1045.5</td>
      <td>548.50</td>
      <td>109.18</td>
      <td>10.347</td>
      <td>6.4684</td>
      <td>112.020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.94915</td>
      <td>1022.2</td>
      <td>78.335</td>
      <td>2.7789</td>
      <td>22.264</td>
      <td>1068.8</td>
      <td>549.95</td>
      <td>125.88</td>
      <td>11.256</td>
      <td>3.6335</td>
      <td>88.147</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.00750</td>
      <td>1021.7</td>
      <td>76.942</td>
      <td>2.8170</td>
      <td>23.358</td>
      <td>1075.2</td>
      <td>549.63</td>
      <td>132.21</td>
      <td>11.702</td>
      <td>3.1972</td>
      <td>87.078</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.78240</td>
      <td>1022.6</td>
      <td>73.535</td>
      <td>2.8327</td>
      <td>23.337</td>
      <td>1075.7</td>
      <td>550.01</td>
      <td>133.18</td>
      <td>11.745</td>
      <td>3.7350</td>
      <td>85.749</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;AP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1015.6900173490633</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The mean AP value for CO levels above 3 <em>mg/$m^3$</em> is 1015.69<a rel="noopener" class="anchor-link" href="#The-mean-AP-value-for-CO-levels-above-3-mg/$m^3$-is-1015.69">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd726bbeeb0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Correlation Heatmap<a rel="noopener" class="anchor-link" href="#Correlation-Heatmap">&#182;</a></h2><h3>There are a few variables are are highly correlated. It appears that AFDP, GTEP, TIT, TEY and CPD are all highly correlated with each other.<a rel="noopener" class="anchor-link" href="#There-are-a-few-variables-are-are-highly-correlated.-It-appears-that-AFDP,-GTEP,-TIT,-TEY-and-CPD-are-all-highly-correlated-with-each-other.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TEY&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CDP&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x7fd72c8ac580&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4>Create histograms for CO and NOX.<a rel="noopener" class="anchor-link" href="#Create-histograms-for-CO-and-NOX.">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>CO Histogram<a rel="noopener" class="anchor-link" href="#CO-Histogram">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>NOX Histogram<a rel="noopener" class="anchor-link" href="#NOX-Histogram">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NOX&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Prepare data from machine learning<a rel="noopener" class="anchor-link" href="#Prepare-data-from-machine-learning">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will predict CO using all the other variables. The NOX will not be used. That is another emission gas that can be predicted as well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">CO</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">555</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">555</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Standardization of the data</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(4651, 9)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(1994, 9)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(739, 9)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q2 [10]<a rel="noopener" class="anchor-link" href="#Q2-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Apply Linear Regression. Predict CO emission using other variables.<ul>
<li>What is the model $R^2$ (on training data)?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the Root Mean Squared Error (RMSE) on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
</ul>
<blockquote><ul>
<li>$R^2$ higher is better. ($R^2$ is % variation in data being explained)  </li>
<li>RMSE lower is better. (RMSE is error, meaning the difference between predictions and actual data)  </li>
</ul>
</blockquote>
<p>Hint:</p>
<ul>
<li>You can use the <code>r2_score</code> and <code>mean_squared_error</code> methods in <code>sklearn.metrics</code>.   </li>
<li>You need to take the square root of Mean Squared Error to get to RMSE. (MSE $-&gt;$ square root $-&gt;$ RMSE)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6468752136774542</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6290818432737131</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>$R^2$ for the training set is 0.65 and for the validation set is 0.63<a rel="noopener" class="anchor-link" href="#$R^2$-for-the-training-set-is-0.65-and-for-the-validation-set-is-0.63">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.3132338270806214</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The Root Mean Square Error for the training data is 1.31<a rel="noopener" class="anchor-link" href="#The-Root-Mean-Square-Error-for-the-training-data-is-1.31">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[28]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.3917448633939091</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The Root Mean Square Error for the validation data is 1.39<a rel="noopener" class="anchor-link" href="#The-Root-Mean-Square-Error-for-the-validation-data-is-1.39">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q3 [10]<a rel="noopener" class="anchor-link" href="#Q3-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Apply Random Forest Regression with 100 trees. Predict CO emission using other variables.</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Is training and validation score close? If not what might be the problem?</p>
</li>
<li>If there is a large gap, try to decrease the gap by changing some hyperparameters of the Random Forest model. (In this analysis, any difference more than 0.10 $R^2$ difference can be assumed to be large.)<ul>
<li>Once you reach a difference of less than or close to 0.10 between training $R^2$ and validation $R^2$ you can stop. </li>
<li>During this process your training score will probably decrease, and that is OK. </li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestRegressor()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[33]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9617080517734191</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The $R^2$ score for the training data is 0.96<a rel="noopener" class="anchor-link" href="#The-$R^2$-score-for-the-training-data-is-0.96">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[35]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.747111035781487</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The $R^2$ for the validation data is 0.74<a rel="noopener" class="anchor-link" href="#The-$R^2$-for-the-validation-data-is-0.74">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.43244580781877695</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The RMSE for the training data is 0.43<a rel="noopener" class="anchor-link" href="#The-RMSE-for-the-training-data-is-0.43">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1491732801048378</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The RMSE for the validation data is 1.15<a rel="noopener" class="anchor-link" href="#The-RMSE-for-the-validation-data-is-1.15">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training and validation data scores for $R^2$ and RMSE are not very close. This could be an indication of overfitting, where out model fits too closely to the training data, and then cannot accurately score the validation data.<a rel="noopener" class="anchor-link" href="#The-training-and-validation-data-scores-for-$R^2$-and-RMSE-are-not-very-close.-This-could-be-an-indication-of-overfitting,-where-out-model-fits-too-closely-to-the-training-data,-and-then-cannot-accurately-score-the-validation-data.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BEST PARAMS: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>

    <span class="n">means</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
    <span class="n">stds</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;std_test_score&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (+/-</span><span class="si">{}</span><span class="s1">) for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">params</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;ccp_alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">regr</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}

0.727 (+/-0.176) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.728 (+/-0.164) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.734 (+/-0.178) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.735 (+/-0.181) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.721 (+/-0.165) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.736 (+/-0.178) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.73 (+/-0.172) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.733 (+/-0.177) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.72 (+/-0.19) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.735 (+/-0.189) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.731 (+/-0.179) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.734 (+/-0.185) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.732 (+/-0.178) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.737 (+/-0.181) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.737 (+/-0.176) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.734 (+/-0.189) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.732 (+/-0.166) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.732 (+/-0.179) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.735 (+/-0.173) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.733 (+/-0.179) for {&#39;ccp_alpha&#39;: 0, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.715 (+/-0.165) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.714 (+/-0.156) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.718 (+/-0.173) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.723 (+/-0.164) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.71 (+/-0.181) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.722 (+/-0.169) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.722 (+/-0.169) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.712 (+/-0.177) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.719 (+/-0.169) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.724 (+/-0.165) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.725 (+/-0.17) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.722 (+/-0.176) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.721 (+/-0.151) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.723 (+/-0.173) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.724 (+/-0.164) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.726 (+/-0.172) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.725 (+/-0.18) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.726 (+/-0.18) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.725 (+/-0.167) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.72 (+/-0.171) for {&#39;ccp_alpha&#39;: 0.01, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.7 (+/-0.155) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.703 (+/-0.162) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.704 (+/-0.163) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.708 (+/-0.167) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.708 (+/-0.154) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.709 (+/-0.167) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.708 (+/-0.166) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.706 (+/-0.166) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.695 (+/-0.155) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.705 (+/-0.154) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.709 (+/-0.167) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.708 (+/-0.163) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.709 (+/-0.161) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.709 (+/-0.161) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.707 (+/-0.171) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.705 (+/-0.159) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.706 (+/-0.169) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.707 (+/-0.16) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.709 (+/-0.167) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.711 (+/-0.164) for {&#39;ccp_alpha&#39;: 0.05, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.695 (+/-0.156) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.683 (+/-0.157) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.693 (+/-0.161) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.693 (+/-0.156) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.691 (+/-0.16) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.691 (+/-0.158) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.696 (+/-0.159) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.698 (+/-0.161) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.692 (+/-0.15) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.696 (+/-0.165) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.693 (+/-0.164) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.695 (+/-0.169) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.69 (+/-0.152) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.692 (+/-0.167) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.691 (+/-0.162) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.693 (+/-0.162) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.691 (+/-0.166) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.696 (+/-0.163) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.696 (+/-0.17) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.696 (+/-0.164) for {&#39;ccp_alpha&#39;: 0.1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.586 (+/-0.106) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.594 (+/-0.099) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.594 (+/-0.122) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.594 (+/-0.11) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.599 (+/-0.125) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.593 (+/-0.108) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.596 (+/-0.1) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.59 (+/-0.109) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.597 (+/-0.146) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.594 (+/-0.114) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.596 (+/-0.117) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.596 (+/-0.11) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.598 (+/-0.106) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.593 (+/-0.106) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.589 (+/-0.106) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.592 (+/-0.114) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.59 (+/-0.093) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.6 (+/-0.115) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.596 (+/-0.108) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.598 (+/-0.113) for {&#39;ccp_alpha&#39;: 0.5, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
0.498 (+/-0.113) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 25}
0.497 (+/-0.1) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
0.498 (+/-0.096) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 75}
0.497 (+/-0.098) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
0.499 (+/-0.099) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 25}
0.495 (+/-0.102) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 50}
0.495 (+/-0.092) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 75}
0.496 (+/-0.098) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 3, &#39;n_estimators&#39;: 100}
0.497 (+/-0.098) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 25}
0.496 (+/-0.091) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 50}
0.496 (+/-0.094) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 75}
0.499 (+/-0.099) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 100}
0.499 (+/-0.094) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 25}
0.498 (+/-0.1) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 50}
0.497 (+/-0.105) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 75}
0.498 (+/-0.097) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 7, &#39;n_estimators&#39;: 100}
0.495 (+/-0.106) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 25}
0.495 (+/-0.094) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 50}
0.499 (+/-0.095) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 75}
0.497 (+/-0.102) for {&#39;ccp_alpha&#39;: 1, &#39;min_samples_split&#39;: 10, &#39;n_estimators&#39;: 100}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">ccp_alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[42]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestRegressor(ccp_alpha=0, min_samples_split=7, n_estimators=50)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[44]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9266037971894621</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[46]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7496786174744476</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ccp_alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[48]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestRegressor(ccp_alpha=0.1, n_estimators=75)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7522947469201016</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[52]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6823895995033364</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>I changed the minimum sample split and ccp alpha value and I found a result with a difference of less than 0.1. I changed the minimum sample split to 2, and set a ccp alpha value of 0.1, when I changed these three parameters, I got a training score of 0.75 and a validation score of 0.68.<a rel="noopener" class="anchor-link" href="#I-changed-the-minimum-sample-split-and-ccp-alpha-value-and-I-found-a-result-with-a-difference-of-less-than-0.1.-I-changed-the-minimum-sample-split-to-2,-and-set-a-ccp-alpha-value-of-0.1,-when-I-changed-these-three-parameters,-I-got-a-training-score-of-0.75-and-a-validation-score-of-0.68.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q4 [10]<a rel="noopener" class="anchor-link" href="#Q4-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Apply Support Vector Regression. Predict CO emission using other variables.</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Apply the process above using <strong>linear kernel SVR</strong>, <strong>polynomial kernel SVR</strong>, and <strong>RBF kernel SVR</strong>.</p>
</li>
<li><p>Take RBF Kernel SVM and perform some hyperparameter tuning. See if you can increase the $R^2$ score.</p>
<ul>
<li>During this process this make sure it doesn&#39;t overfit the data. </li>
<li>Look into the <code>C</code> and <code>gamma</code> values.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">SVR_Model</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">SVR_Model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[54]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">SVR_Model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[56]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7537814347693682</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[57]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0965750440937958</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training $R^2$ score is 0.75 and the RMSE score is 1.1<a rel="noopener" class="anchor-link" href="#The-training-$R^2$-score-is-0.75-and-the-RMSE-score-is-1.1">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">SVR_Model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[59]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7239434577070454</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[60]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.2006587843948826</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The validation $R^2$ score is 0.72 and the RMSE score is 1.2<a rel="noopener" class="anchor-link" href="#The-validation-$R^2$-score-is-0.72-and-the-RMSE-score-is-1.2">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Linear SVM Regressor<a rel="noopener" class="anchor-link" href="#Linear-SVM-Regressor">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_lin</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_lin</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[62]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=1000.0, kernel=&#39;linear&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_lin</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[64]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6149426892609726</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[65]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.3713257989253163</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training $R^2$ value is 0.61 and the RMSE score is 1.37<a rel="noopener" class="anchor-link" href="#The-training-$R^2$-value-is-0.61-and-the-RMSE-score-is-1.37">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_lin</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[67]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5930338258255874</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[68]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.4578060135156587</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The validation $R^2$ value is 0.59 and the RMSE value is 1.46<a rel="noopener" class="anchor-link" href="#The-validation-$R^2$-value-is-0.59-and-the-RMSE-value-is-1.46">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Polynomial Kernel SVM Regressor<a rel="noopener" class="anchor-link" href="#Polynomial-Kernel-SVM-Regressor">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_poly</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[70]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([54538131.20261115, 58099567.26492375, 75472028.41162759, ...,
       26192005.37934858, 66660764.20259434, 55564528.95199674])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[72]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7294267445571342</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[73]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1495302210444531</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The $R^2$ value for the training set is 0.73 and the RMSE value is 1.15<a rel="noopener" class="anchor-link" href="#The-$R^2$-value-for-the-training-set-is-0.73-and-the-RMSE-value-is-1.15">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[75]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6736062790139807</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[76]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.305543895305146</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The $R^2$ value for the validation set is 0.67 and the RMSE for the validation set is 1.31<a rel="noopener" class="anchor-link" href="#The-$R^2$-value-for-the-validation-set-is-0.67-and-the-RMSE-for-the-validation-set-is-1.31">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>RBF kernel SVR<a rel="noopener" class="anchor-link" href="#RBF-kernel-SVR">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[78]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=1000.0, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[80]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7950424425485095</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[81]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.000483494477407</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training $R^2$ value is 0.80 and the RMSE score is 1<a rel="noopener" class="anchor-link" href="#The-training-$R^2$-value-is-0.80-and-the-RMSE-score-is-1">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[83]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6970894436046302</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[84]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.2577020969409263</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The validation $R^2$ value is 0.70 and the RMSE score is 1.26<a rel="noopener" class="anchor-link" href="#The-validation-$R^2$-value-is-0.70-and-the-RMSE-score-is-1.26">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BEST PARAMS: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>

    <span class="n">means</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
    <span class="n">stds</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;std_test_score&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">stds</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (+/-</span><span class="si">{}</span><span class="s1">) for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">params</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svr_rbf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}

0.125 (+/-0.043) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.1}
-0.011 (+/-0.031) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.5}
-0.048 (+/-0.031) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 1}
-0.076 (+/-0.031) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 5}
-0.078 (+/-0.031) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 10}
0.387 (+/-0.086) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.1}
0.172 (+/-0.054) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.5}
0.054 (+/-0.035) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 1}
-0.064 (+/-0.03) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 5}
-0.074 (+/-0.03) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 10}
0.473 (+/-0.104) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.1}
0.273 (+/-0.071) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.5}
0.141 (+/-0.048) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 1}
-0.048 (+/-0.028) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 5}
-0.069 (+/-0.03) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 10}
0.641 (+/-0.139) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.1}
0.478 (+/-0.113) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.5}
0.352 (+/-0.09) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 1}
0.047 (+/-0.031) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 5}
-0.027 (+/-0.026) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 10}
0.697 (+/-0.153) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1}
0.571 (+/-0.129) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.5}
0.438 (+/-0.107) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 1}
0.12 (+/-0.041) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 5}
0.015 (+/-0.025) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 10}
0.749 (+/-0.168) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.1}
0.716 (+/-0.155) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.5}
0.664 (+/-0.143) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 1}
0.324 (+/-0.081) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 5}
0.185 (+/-0.047) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 10}
0.753 (+/-0.171) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.1}
0.733 (+/-0.162) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.5}
0.703 (+/-0.153) for {&#39;C&#39;: 1, &#39;gamma&#39;: 1}
0.427 (+/-0.098) for {&#39;C&#39;: 1, &#39;gamma&#39;: 5}
0.276 (+/-0.064) for {&#39;C&#39;: 1, &#39;gamma&#39;: 10}
0.758 (+/-0.174) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.1}
0.749 (+/-0.173) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.5}
0.736 (+/-0.172) for {&#39;C&#39;: 5, &#39;gamma&#39;: 1}
0.587 (+/-0.123) for {&#39;C&#39;: 5, &#39;gamma&#39;: 5}
0.447 (+/-0.104) for {&#39;C&#39;: 5, &#39;gamma&#39;: 10}
0.759 (+/-0.175) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}
0.748 (+/-0.171) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}
0.735 (+/-0.17) for {&#39;C&#39;: 10, &#39;gamma&#39;: 1}
0.597 (+/-0.125) for {&#39;C&#39;: 10, &#39;gamma&#39;: 5}
0.466 (+/-0.106) for {&#39;C&#39;: 10, &#39;gamma&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[89]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=10, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[91]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7667524817588922</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[92]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.067299916893449</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[94]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.738793267251711</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[95]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1679191086768477</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>By performing a gridsearch, I found the ideal parameters to be C=10 and gamma = 0.1. After adjusting these parameters, fitting the model and making predictions again, we saw a slight dip in the training $R^2$ score from 0.80 to 0.77, but we saw an increase in the $R^2$ score of the validation model from 0.70 to 0.74.<a rel="noopener" class="anchor-link" href="#By-performing-a-gridsearch,-I-found-the-ideal-parameters-to-be-C=10-and-gamma-=-0.1.-After-adjusting-these-parameters,-fitting-the-model-and-making-predictions-again,-we-saw-a-slight-dip-in-the-training-$R^2$-score-from-0.80-to-0.77,-but-we-saw-an-increase-in-the-$R^2$-score-of-the-validation-model-from-0.70-to-0.74.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q5 [10]<a rel="noopener" class="anchor-link" href="#Q5-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Apply PCA and transform the data. </li>
<li>Take sufficient number of components based on variance explained and/or validation accuracy using one of the models from before. (Linear reg, RF reg, or SVR)</li>
<li>Use the PCA transformed data to perform regression.</li>
<li><p>Apply Linear Regression, Random Forest Regression, and RBF Kernel Support Vector Regression.
For each model:</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Compare these models with their counterparts obtained before. For example: Compare PCA SVR with SVR from before. Use the best hyperparameters obtained from the experiments before to fit the SVR onto the PCA transformed data. Any change in performance? Please explain.</p>
</li>
<li>Perform hyperparameter tuning of SVR using PCA transformed data. Any improvement?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">X_test_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[98]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([5.81314778e-01, 2.07936879e-01, 9.93025006e-02, 5.49454071e-02,
       4.35326353e-02, 9.09814154e-03, 3.62801262e-03, 1.66600851e-04,
       7.50450512e-05])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>I will choose to use 4 components because they have a combined variance of over 90%<a rel="noopener" class="anchor-link" href="#I-will-choose-to-use-4-components-because-they-have-a-combined-variance-of-over-90%">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[99]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pca_train</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pca_train</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_pca</span> <span class="o">=</span> <span class="n">pca_train</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val_pca</span> <span class="o">=</span> <span class="n">pca_train</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">X_test_pca</span> <span class="o">=</span> <span class="n">pca_train</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[102]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[103]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6128523714371701</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[105]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5925986135843698</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[106]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.3750429430125595</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[107]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.4585852987864274</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>For linear regression, once the PCA was applied the training $R^2$ score was 0.61 and the RMSE score is 1.38 and the validation $R^2$ score 0.59 and a validation RMSE score of 1.46<a rel="noopener" class="anchor-link" href="#For-linear-regression,-once-the-PCA-was-applied-the-training-$R^2$-score-was-0.61-and-the-RMSE-score-is-1.38-and-the-validation-$R^2$-score-0.59-and-a-validation-RMSE-score-of-1.46">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ccp_alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[110]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7231293179181915</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[111]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[112]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[112]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6206852019409694</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[113]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[113]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.162830582312317</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[114]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[114]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.4074094853091657</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>For the random forest regression, the training set had a $R^2$ score of 0.72 and an RMSE score of 1.16 and the validation set had a $R^2$ score of 0.62 and a RMSE score of 1.41<a rel="noopener" class="anchor-link" href="#For-the-random-forest-regression,-the-training-set-had-a-$R^2$-score-of-0.72-and-an-RMSE-score-of-1.16-and-the-validation-set-had-a-$R^2$-score-of-0.62-and-a-RMSE-score-of-1.41">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[116]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[117]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7456823389845232</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[119]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.705196268757198</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[120]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1144644514946784</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[121]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.240757955908685</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The training set for svr_rbf returned a $R^2$ value of 0.75 and a RMSE of 1.11 and the validation set returned a $R^2$ value of 0.71 and a RMSE value of 1.24<a rel="noopener" class="anchor-link" href="#The-training-set-for-svr_rbf-returned-a-$R^2$-value-of-0.75-and-a-RMSE-of-1.11-and-the-validation-set-returned-a-$R^2$-value-of-0.71-and-a-RMSE-value-of-1.24">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>For the linear regression model, the $R^2$ values decreased for both the training (from 0.65 to 0.61) and valdiation sets (from 0.63 to 0.59). The RMSE values also increased for both sets (training from 1.31 to 1.38 and validation from 1.39 to 1.46).<a rel="noopener" class="anchor-link" href="#For-the-linear-regression-model,-the-$R^2$-values-decreased-for-both-the-training-(from-0.65-to-0.61)-and-valdiation-sets-(from-0.63-to-0.59).-The-RMSE-values-also-increased-for-both-sets-(training-from-1.31-to-1.38-and-validation-from-1.39-to-1.46).">&#182;</a></h3><h3>For the random forest, the training $R^2$ also decreased, from 0.75 to 0.72 and the validation $R^2$ also decreased from 0.69 to 0.62<a rel="noopener" class="anchor-link" href="#For-the-random-forest,-the-training-$R^2$-also-decreased,-from-0.75-to-0.72-and-the-validation-$R^2$-also-decreased-from-0.69-to-0.62">&#182;</a></h3><h3>The Support Vector Regression also saw a decrease in $R^2$ scores, the training scores decreased from 0.77 to 0.75 and the validation scores decreased from 0.74 to 0.70<a rel="noopener" class="anchor-link" href="#The-Support-Vector-Regression-also-saw-a-decrease-in-$R^2$-scores,-the-training-scores-decreased-from-0.77-to-0.75-and-the-validation-scores-decreased-from-0.74-to-0.70">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q6 [10]<a rel="noopener" class="anchor-link" href="#Q6-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Apply Kernel PCA (KPCA) and transform the data. </li>
<li>After the kernel transformation of your data/vectors live in different feature space.<ul>
<li>That&#39;s why in KPCA you will (in many cases) have more dimensions than your original number of features! </li>
<li>The full returned matrix will be NxN size. </li>
<li>Here we will select 100 componenets to cut on training time, otherwise it might take too long.</li>
</ul>
</li>
<li>You can either stick with 100 kernel principal components or take lesser number of components. You can make use of the <code>lambdas_</code> attribute which are the eigenvalues in the higher dimensional space - and act similar to PCA variance explained.</li>
<li>Use the KPCA transformed data to perform regression.</li>
<li><p>Now apply Linear Regression, Random Forest Regression, and RBF Kernel Support Vector Regression.
For each model:</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Compare these models with their counterparts obtained before. For example: Compare KPCA SVR with SVR and PCA SVR from before. Use the best hyperparameters obtained from the experiments before.</p>
<ul>
<li>Is there any change in performance when compared to models trained on original data? Please explain. </li>
<li>Is there any change in performance when compared to models trained on PCA transformed data? Please explain. </li>
</ul>
</li>
<li><p>Perform hyperparameter tuning of SVR using KPCA transformed data. Any improvement?</p>
</li>
</ul>
<p>========</p>
<ul>
<li>What is your conclusion considering all the regression models? Which one would you choose as your final contender?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[122]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">KernelPCA</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[123]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">kpca</span> <span class="o">=</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">remove_zero_eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="s1">&#39;RandomState&#39;</span><span class="p">)</span>
<span class="n">kpca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[124]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_train_kpca</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[124]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(4651, 100)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[125]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_val_kpca</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[125]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(1994, 100)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[127]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[128]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[129]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[129]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7580770439351178</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[130]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[130]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.086967352556054</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[131]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[132]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[132]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7255978146578295</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[133]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[133]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1970557126273629</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Linear Regression<a rel="noopener" class="anchor-link" href="#Linear-Regression">&#182;</a></h2><h3>For the training set the $R^2$ value is 0.76 and the RMSE value is 1.09. For the validation set, the $R^2$ value is 0.73 and the RMSE value is 1.20<a rel="noopener" class="anchor-link" href="#For-the-training-set-the-$R^2$-value-is-0.76-and-the-RMSE-value-is-1.09.-For-the-validation-set,-the-$R^2$-value-is-0.73-and-the-RMSE-value-is-1.20">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[134]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ccp_alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[135]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[136]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[136]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7590823180269908</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[137]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[137]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0847066377442958</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[138]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[139]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[139]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6471638110315807</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[140]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[140]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.357397802999127</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Random Forest<a rel="noopener" class="anchor-link" href="#Random-Forest">&#182;</a></h2><h3>For the training set the $R^2$ value is 0.76 and the RMSE value is 1.08. For the validation set the $R^2$ value is 0.65 and the RMSE value is 1.36<a rel="noopener" class="anchor-link" href="#For-the-training-set-the-$R^2$-value-is-0.76-and-the-RMSE-value-is-1.08.-For-the-validation-set-the-$R^2$-value-is-0.65-and-the-RMSE-value-is-1.36">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[141]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[142]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[143]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[143]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7529633384307788</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[144]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[144]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0983952969128699</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[145]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[146]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[146]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7304797312459077</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[147]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[147]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.186359455923635</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>RBF Kernal Support Vector Regression<a rel="noopener" class="anchor-link" href="#RBF-Kernal-Support-Vector-Regression">&#182;</a></h2><h3>For the training set the $R^2$ value is 0.75 and the RMSE score is 1.10. For the validation set, the $R^2$ value is 0.73 and the RMSE value is 1.19<a rel="noopener" class="anchor-link" href="#For-the-training-set-the-$R^2$-value-is-0.75-and-the-RMSE-score-is-1.10.-For-the-validation-set,-the-$R^2$-value-is-0.73-and-the-RMSE-value-is-1.19">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The linear regression saw improvement across the board, in the training set, the $R^2$ value increase to 0.76 and the RMSE value fell to it&#39;s lowest at 1.09. For the validation set, we saw the highest $R^2$ value of 0.73 and the lowest RMSE value of 1.2.<a rel="noopener" class="anchor-link" href="#The-linear-regression-saw-improvement-across-the-board,-in-the-training-set,-the-$R^2$-value-increase-to-0.76-and-the-RMSE-value-fell-to-it&#39;s-lowest-at-1.09.-For-the-validation-set,-we-saw-the-highest-$R^2$-value-of-0.73-and-the-lowest-RMSE-value-of-1.2.">&#182;</a></h3><h3>For Random Forest, the $R^2$ score for training set was 0.76, which is the highest for random forest so far. The $R^2$ score for the validation set came in at 0.65, which was between the first two $R^2$ values, higher than the PCA regression, but lower than the original regression.<a rel="noopener" class="anchor-link" href="#For-Random-Forest,-the-$R^2$-score-for-training-set-was-0.76,-which-is-the-highest-for-random-forest-so-far.-The-$R^2$-score-for-the-validation-set-came-in-at-0.65,-which-was-between-the-first-two-$R^2$-values,-higher-than-the-PCA-regression,-but-lower-than-the-original-regression.">&#182;</a></h3><h3>For the Support Vector Regression, the $R^2$ value for the training set was 0.75 which is the same as the inital $R^2$ score, and the validation set had an $R^2$ value of 0.73, which is between the other two $R^2$ values, higher than the PCA score but lower than the orignal score.<a rel="noopener" class="anchor-link" href="#For-the-Support-Vector-Regression,-the-$R^2$-value-for-the-training-set-was-0.75-which-is-the-same-as-the-inital-$R^2$-score,-and-the-validation-set-had-an-$R^2$-value-of-0.73,-which-is-between-the-other-two-$R^2$-values,-higher-than-the-PCA-score-but-lower-than-the-orignal-score.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[148]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[149]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svr_rbf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}

-0.038 (+/-0.03) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.1}
0.036 (+/-0.033) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.5}
0.046 (+/-0.035) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 1}
-0.046 (+/-0.031) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 5}
-0.066 (+/-0.031) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 10}
0.099 (+/-0.041) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.1}
0.28 (+/-0.069) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.5}
0.293 (+/-0.071) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 1}
0.064 (+/-0.036) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 5}
-0.021 (+/-0.028) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 10}
0.211 (+/-0.057) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.1}
0.384 (+/-0.088) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.5}
0.395 (+/-0.091) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 1}
0.156 (+/-0.05) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 5}
0.029 (+/-0.032) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 10}
0.451 (+/-0.099) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.1}
0.575 (+/-0.124) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.5}
0.587 (+/-0.128) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 1}
0.378 (+/-0.095) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 5}
0.22 (+/-0.063) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 10}
0.529 (+/-0.115) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1}
0.644 (+/-0.139) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.5}
0.655 (+/-0.141) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 1}
0.469 (+/-0.112) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 5}
0.311 (+/-0.082) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 10}
0.685 (+/-0.149) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.1}
0.742 (+/-0.164) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.5}
0.745 (+/-0.165) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 1}
0.687 (+/-0.145) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 5}
0.555 (+/-0.121) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 10}
0.728 (+/-0.16) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.1}
0.75 (+/-0.168) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.5}
0.752 (+/-0.169) for {&#39;C&#39;: 1, &#39;gamma&#39;: 1}
0.721 (+/-0.156) for {&#39;C&#39;: 1, &#39;gamma&#39;: 5}
0.651 (+/-0.134) for {&#39;C&#39;: 1, &#39;gamma&#39;: 10}
0.75 (+/-0.169) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.1}
0.757 (+/-0.175) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.5}
0.757 (+/-0.176) for {&#39;C&#39;: 5, &#39;gamma&#39;: 1}
0.743 (+/-0.17) for {&#39;C&#39;: 5, &#39;gamma&#39;: 5}
0.712 (+/-0.161) for {&#39;C&#39;: 5, &#39;gamma&#39;: 10}
0.753 (+/-0.172) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}
0.758 (+/-0.177) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}
0.756 (+/-0.177) for {&#39;C&#39;: 10, &#39;gamma&#39;: 1}
0.741 (+/-0.165) for {&#39;C&#39;: 10, &#39;gamma&#39;: 5}
0.711 (+/-0.162) for {&#39;C&#39;: 10, &#39;gamma&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[150]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[151]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[151]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=10, gamma=0.5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[153]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[153]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7684172900202348</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[154]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[154]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.063484159983866</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[155]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[156]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[156]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7370339476138834</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[157]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[157]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1718456819881358</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>After identify the optimal parameters and applying them to the Support Vector Regression, There was a slight improvement in the $R^2$ scores for both training (from 0.75 to 0.77) and validation (from 0.73 to 0.74)<a rel="noopener" class="anchor-link" href="#After-identify-the-optimal-parameters-and-applying-them-to-the-Support-Vector-Regression,-There-was-a-slight-improvement-in-the-$R^2$-scores-for-both-training-(from-0.75-to-0.77)-and-validation-(from-0.73-to-0.74)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Overall, the best regression model would be to the Support Vector Regression we just tuned with a training $R^2$ score of 0.77 and an RMSE value of 1.06 and a validation $R^2$ score of 0.74 and an RMSE value of 1.17<a rel="noopener" class="anchor-link" href="#Overall,-the-best-regression-model-would-be-to-the-Support-Vector-Regression-we-just-tuned-with-a-training-$R^2$-score-of-0.77-and-an-RMSE-value-of-1.06-and-a-validation-$R^2$-score-of-0.74-and-an-RMSE-value-of-1.17">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q7 [10]<a rel="noopener" class="anchor-link" href="#Q7-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4>Let&#39;s do some classification<a rel="noopener" class="anchor-link" href="#Let&#39;s-do-some-classification">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will convert CO target values into binary form by comparing them to a threshold. $ 0 - 3  mg/m^3$ is the range of max 8-hour avg. ambient CO in most US cities. So let&#39;s take that.<br/>
<a rel="noopener" href="https://www.carbonmonoxidekills.com/are-you-at-risk/carbon-monoxide-levels/">CO Levels of Concern in Government Recommendations and Regulations</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[158]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">Binarizer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[159]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">binarizer</span> <span class="o">=</span> <span class="n">Binarizer</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[160]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y_train_cat</span> <span class="o">=</span> <span class="n">binarizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_val_cat</span> <span class="o">=</span> <span class="n">binarizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_test_cat</span> <span class="o">=</span> <span class="n">binarizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[161]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y_train_cat</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[162]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Fit RBF Kernel SVM Classifier<a rel="noopener" class="anchor-link" href="#Fit-RBF-Kernel-SVM-Classifier">&#182;</a></h3><h4>1. Standardized training data<a rel="noopener" class="anchor-link" href="#1.-Standardized-training-data">&#182;</a></h4><ul>
<li>Using the standardized training data perform grid search:<ul>
<li>Find the best combination of the <code>C</code> and <code>gamma</code> hyper-parameters.  </li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the validation set:<ul>
<li>Create confusion matrix</li>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4>2. PCA transformed training data<a rel="noopener" class="anchor-link" href="#2.-PCA-transformed-training-data">&#182;</a></h4><ul>
<li>Using the <strong>pca</strong> transformed training data perform grid search:<ul>
<li>Find the best combination of the <code>C</code> and <code>gamma</code> hyper-parameters.  </li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the validation set:<ul>
<li>Create confusion matrix</li>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4>3. Kernel PCA transformed training data<a rel="noopener" class="anchor-link" href="#3.-Kernel-PCA-transformed-training-data">&#182;</a></h4><ul>
<li>Using the <strong>kernel pca</strong> transformed training data perform grid search:<ul>
<li>Find the best combination of the <code>C</code> and <code>gamma</code> hyper-parameters.  </li>
</ul>
</li>
<li><p>For the best model:</p>
<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the validation set:<ul>
<li>Create confusion matrix</li>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
</ul>
</li>
<li><p>Compare the results of Kernel RBF SVM model 1, 2, and 3. Which one is the best?</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[163]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[164]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>SVC Model 1<a rel="noopener" class="anchor-link" href="#SVC-Model-1">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[165]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}

0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 10}
0.892 (+/-0.024) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.1}
0.72 (+/-0.009) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 10}
0.895 (+/-0.018) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.1}
0.871 (+/-0.01) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.5}
0.678 (+/-0.002) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 10}
0.908 (+/-0.017) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.1}
0.913 (+/-0.019) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.5}
0.911 (+/-0.02) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 1}
0.618 (+/-0.003) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 10}
0.913 (+/-0.015) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1}
0.914 (+/-0.017) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.5}
0.913 (+/-0.021) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 1}
0.688 (+/-0.01) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 10}
0.916 (+/-0.011) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.1}
0.916 (+/-0.014) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.5}
0.914 (+/-0.014) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 1}
0.898 (+/-0.013) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 5}
0.806 (+/-0.016) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 10}
0.917 (+/-0.013) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.1}
0.914 (+/-0.014) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.5}
0.916 (+/-0.012) for {&#39;C&#39;: 1, &#39;gamma&#39;: 1}
0.908 (+/-0.012) for {&#39;C&#39;: 1, &#39;gamma&#39;: 5}
0.865 (+/-0.015) for {&#39;C&#39;: 1, &#39;gamma&#39;: 10}
0.916 (+/-0.013) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.1}
0.916 (+/-0.009) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.5}
0.914 (+/-0.01) for {&#39;C&#39;: 5, &#39;gamma&#39;: 1}
0.902 (+/-0.017) for {&#39;C&#39;: 5, &#39;gamma&#39;: 5}
0.865 (+/-0.009) for {&#39;C&#39;: 5, &#39;gamma&#39;: 10}
0.917 (+/-0.017) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}
0.919 (+/-0.011) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}
0.909 (+/-0.008) for {&#39;C&#39;: 10, &#39;gamma&#39;: 1}
0.895 (+/-0.015) for {&#39;C&#39;: 10, &#39;gamma&#39;: 5}
0.864 (+/-0.012) for {&#39;C&#39;: 10, &#39;gamma&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[167]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[168]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[168]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVC(C=10, gamma=0.5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[169]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[170]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[170]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9453880885831004</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[171]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[172]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[172]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9242728184553661</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[173]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1118,   77],
       [  74,  725]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[174]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[174]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9073842302878599</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[175]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[175]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9355648535564853</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[176]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[176]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9039900249376559</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[177]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[177]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9214745419221726</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[178]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[178]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.905683947532792</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The recall score is 0.91<a rel="noopener" class="anchor-link" href="#The-recall-score-is-0.91">&#182;</a></h3><h3>The specificity score is 0.94<a rel="noopener" class="anchor-link" href="#The-specificity-score-is-0.94">&#182;</a></h3><h3>The precision score is 0.90<a rel="noopener" class="anchor-link" href="#The-precision-score-is-0.90">&#182;</a></h3><h3>The balanced accuracy score is 0.92<a rel="noopener" class="anchor-link" href="#The-balanced-accuracy-score-is-0.92">&#182;</a></h3><h3>The F1 score is 0.91<a rel="noopener" class="anchor-link" href="#The-F1-score-is-0.91">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>SVC Model 2<a rel="noopener" class="anchor-link" href="#SVC-Model-2">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[179]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[180]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[181]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}

0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 10}
0.885 (+/-0.029) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.1}
0.791 (+/-0.01) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.5}
0.622 (+/-0.005) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 10}
0.888 (+/-0.021) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.1}
0.875 (+/-0.019) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.5}
0.788 (+/-0.004) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 10}
0.899 (+/-0.015) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.1}
0.906 (+/-0.02) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.5}
0.905 (+/-0.021) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 1}
0.681 (+/-0.013) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 10}
0.906 (+/-0.015) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1}
0.912 (+/-0.017) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.5}
0.912 (+/-0.019) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 1}
0.825 (+/-0.015) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 5}
0.642 (+/-0.007) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 10}
0.914 (+/-0.016) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.1}
0.914 (+/-0.014) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.5}
0.91 (+/-0.012) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 1}
0.908 (+/-0.015) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 5}
0.88 (+/-0.009) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 10}
0.915 (+/-0.017) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.1}
0.912 (+/-0.014) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.5}
0.911 (+/-0.01) for {&#39;C&#39;: 1, &#39;gamma&#39;: 1}
0.909 (+/-0.013) for {&#39;C&#39;: 1, &#39;gamma&#39;: 5}
0.893 (+/-0.014) for {&#39;C&#39;: 1, &#39;gamma&#39;: 10}
0.916 (+/-0.017) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.1}
0.911 (+/-0.016) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.5}
0.911 (+/-0.01) for {&#39;C&#39;: 5, &#39;gamma&#39;: 1}
0.9 (+/-0.012) for {&#39;C&#39;: 5, &#39;gamma&#39;: 5}
0.885 (+/-0.015) for {&#39;C&#39;: 5, &#39;gamma&#39;: 10}
0.916 (+/-0.016) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}
0.913 (+/-0.013) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}
0.909 (+/-0.017) for {&#39;C&#39;: 10, &#39;gamma&#39;: 1}
0.894 (+/-0.017) for {&#39;C&#39;: 10, &#39;gamma&#39;: 5}
0.88 (+/-0.017) for {&#39;C&#39;: 10, &#39;gamma&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[182]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[183]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[183]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVC(C=10, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[184]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[185]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[185]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9180821328746506</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[186]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[187]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[187]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9147442326980942</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[188]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[188]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1123,   72],
       [  98,  701]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[189]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[189]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8773466833541927</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[190]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[190]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9397489539748954</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[191]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[191]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.906856403622251</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[192]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9085478186645441</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[193]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8918575063613232</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The recall score is 0.88<a rel="noopener" class="anchor-link" href="#The-recall-score-is-0.88">&#182;</a></h3><h3>The specificity score is 0.94<a rel="noopener" class="anchor-link" href="#The-specificity-score-is-0.94">&#182;</a></h3><h3>The precision score is 0.91<a rel="noopener" class="anchor-link" href="#The-precision-score-is-0.91">&#182;</a></h3><h3>The balanced accuracy score is 0.91<a rel="noopener" class="anchor-link" href="#The-balanced-accuracy-score-is-0.91">&#182;</a></h3><h3>The F1 score is 0.89<a rel="noopener" class="anchor-link" href="#The-F1-score-is-0.89">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>SVC Model 3<a rel="noopener" class="anchor-link" href="#SVC-Model-3">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[195]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[196]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;C&#39;: 5, &#39;gamma&#39;: 0.1}

0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.001, &#39;gamma&#39;: 10}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.1}
0.867 (+/-0.024) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 0.5}
0.874 (+/-0.022) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 1}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.005, &#39;gamma&#39;: 10}
0.757 (+/-0.006) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.1}
0.895 (+/-0.016) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.5}
0.9 (+/-0.014) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 1}
0.694 (+/-0.008) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 5}
0.617 (+/-0.001) for {&#39;C&#39;: 0.01, &#39;gamma&#39;: 10}
0.896 (+/-0.017) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.1}
0.909 (+/-0.015) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 0.5}
0.912 (+/-0.019) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 1}
0.913 (+/-0.019) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 5}
0.841 (+/-0.014) for {&#39;C&#39;: 0.05, &#39;gamma&#39;: 10}
0.901 (+/-0.017) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1}
0.913 (+/-0.018) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.5}
0.914 (+/-0.021) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 1}
0.913 (+/-0.017) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 5}
0.908 (+/-0.013) for {&#39;C&#39;: 0.1, &#39;gamma&#39;: 10}
0.912 (+/-0.016) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.1}
0.916 (+/-0.013) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 0.5}
0.915 (+/-0.013) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 1}
0.914 (+/-0.014) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 5}
0.915 (+/-0.016) for {&#39;C&#39;: 0.5, &#39;gamma&#39;: 10}
0.913 (+/-0.015) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.1}
0.916 (+/-0.013) for {&#39;C&#39;: 1, &#39;gamma&#39;: 0.5}
0.914 (+/-0.01) for {&#39;C&#39;: 1, &#39;gamma&#39;: 1}
0.915 (+/-0.013) for {&#39;C&#39;: 1, &#39;gamma&#39;: 5}
0.914 (+/-0.011) for {&#39;C&#39;: 1, &#39;gamma&#39;: 10}
0.917 (+/-0.014) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.1}
0.914 (+/-0.014) for {&#39;C&#39;: 5, &#39;gamma&#39;: 0.5}
0.916 (+/-0.016) for {&#39;C&#39;: 5, &#39;gamma&#39;: 1}
0.913 (+/-0.008) for {&#39;C&#39;: 5, &#39;gamma&#39;: 5}
0.906 (+/-0.011) for {&#39;C&#39;: 5, &#39;gamma&#39;: 10}
0.917 (+/-0.014) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1}
0.916 (+/-0.012) for {&#39;C&#39;: 10, &#39;gamma&#39;: 0.5}
0.917 (+/-0.011) for {&#39;C&#39;: 10, &#39;gamma&#39;: 1}
0.91 (+/-0.008) for {&#39;C&#39;: 10, &#39;gamma&#39;: 5}
0.902 (+/-0.014) for {&#39;C&#39;: 10, &#39;gamma&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[198]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[198]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVC(C=5, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[199]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[200]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">accuracyTrain</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[200]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9200172006020211</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[201]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[202]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9232698094282848</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[203]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[203]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1127,   68],
       [  85,  714]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[204]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[204]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8936170212765957</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[205]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">specificity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[205]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9430962343096234</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[206]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[206]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9130434782608695</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[207]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[207]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9183566277931096</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[208]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[208]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9032258064516129</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The recall score is 0.89<a rel="noopener" class="anchor-link" href="#The-recall-score-is-0.89">&#182;</a></h3><h3>The specificity score is 0.94<a rel="noopener" class="anchor-link" href="#The-specificity-score-is-0.94">&#182;</a></h3><h3>The precision score is 0.91<a rel="noopener" class="anchor-link" href="#The-precision-score-is-0.91">&#182;</a></h3><h3>The balanced accuracy score is 0.92<a rel="noopener" class="anchor-link" href="#The-balanced-accuracy-score-is-0.92">&#182;</a></h3><h3>The F1 score is 0.90<a rel="noopener" class="anchor-link" href="#The-F1-score-is-0.90">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Overall, all 3 model performed pretty well, but the best classifier is SVM Model 1. All 5 scores are over 90 with SVM Model 1.<a rel="noopener" class="anchor-link" href="#Overall,-all-3-model-performed-pretty-well,-but-the-best-classifier-is-SVM-Model-1.-All-5-scores-are-over-90-with-SVM-Model-1.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q8 [10]<a rel="noopener" class="anchor-link" href="#Q8-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Using the Support Vector Regressor:<ul>
<li>Think of other ways of improving the regression performance and list at least two possibilities.</li>
<li>You can use any of the datasets we have been using (standardized data, PCA transformed data or the Kernel PCA transformed data), or re-create your own set from the original.</li>
<li>Implement both of the methods you proposed. </li>
<li>Is the validation performance increasing? For performance comparison you can use any regression performance metric that you deem to be appropriate. </li>
<li>If both of them did not improve, comment on why this might have been the case. What else can be done?</li>
<li>Optional: Apply different methods, ideas as you see fit and see if the validation performance is improving.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Two ways we can improve the Support Vector Regressor are by:<a rel="noopener" class="anchor-link" href="#Two-ways-we-can-improve-the-Support-Vector-Regressor-are-by:">&#182;</a></h3><h4>Changing the degree parameter<a rel="noopener" class="anchor-link" href="#Changing-the-degree-parameter">&#182;</a></h4><h4>Changing the epsilon value<a rel="noopener" class="anchor-link" href="#Changing-the-epsilon-value">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Original Regressor (KPCA):<a rel="noopener" class="anchor-link" href="#Original-Regressor-(KPCA):">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[209]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[210]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=10, gamma=0.5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[211]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[212]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[212]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7684172900202348</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[213]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[213]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.063484159983866</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[214]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[215]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[215]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7370339476138834</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[216]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[216]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1718456819881358</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Changing the degree parameter:<a rel="noopener" class="anchor-link" href="#Changing-the-degree-parameter:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[217]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;degree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[218]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svr_rbf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;degree&#39;: 1}

0.758 (+/-0.177) for {&#39;degree&#39;: 1}
0.758 (+/-0.177) for {&#39;degree&#39;: 2}
0.758 (+/-0.177) for {&#39;degree&#39;: 3}
0.758 (+/-0.177) for {&#39;degree&#39;: 4}
0.758 (+/-0.177) for {&#39;degree&#39;: 5}
0.758 (+/-0.177) for {&#39;degree&#39;: 6}
0.758 (+/-0.177) for {&#39;degree&#39;: 7}
0.758 (+/-0.177) for {&#39;degree&#39;: 8}
0.758 (+/-0.177) for {&#39;degree&#39;: 9}
0.758 (+/-0.177) for {&#39;degree&#39;: 10}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[219]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[220]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[220]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=10, degree=2, gamma=0.5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[221]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[222]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[222]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7684172900202348</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[223]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[223]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.063484159983866</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[224]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[225]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[225]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7370339476138834</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[226]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[226]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1718456819881358</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[227]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;degree = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = , validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>degree = 1, Training r2 = 0.7684172900202348, training RMSE = 1.063484159983866, validation r2 = , validation RMSE = 0.7370339476138834
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[228]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">degree</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;degree = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>degree = 2, Training r2 = 0.7684172900202348, training RMSE = 1.063484159983866, validation r2 = 0.7370339476138834, validation RMSE = 1.1718456819881358
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[229]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">degree</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;degree = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>degree = 4, Training r2 = 0.7684172900202348, training RMSE = 1.063484159983866, validation r2 = 0.7370339476138834, validation RMSE = 1.1718456819881358
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[230]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">degree</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;degree = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>degree = 10, Training r2 = 0.7684172900202348, training RMSE = 1.063484159983866, validation r2 = 0.7370339476138834, validation RMSE = 1.1718456819881358
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>After performing a gridsearch and testing several different values for degree, I can say with confidence that changing the degree does not impact the accuracy of the model for the Support Vector Regressor.<a rel="noopener" class="anchor-link" href="#After-performing-a-gridsearch-and-testing-several-different-values-for-degree,-I-can-say-with-confidence-that-changing-the-degree-does-not-impact-the-accuracy-of-the-model-for-the-Support-Vector-Regressor.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Changing the epsilon value:<a rel="noopener" class="anchor-link" href="#Changing-the-epsilon-value:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[231]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epsilon = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>epsilon = 0.05, Training r2 = 0.7681837108835659, training RMSE = 1.0640203509331922, validation r2 = 0.7368181423256492, validation RMSE = 1.172326425852177
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[232]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epsilon = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>epsilon = 0.5, Training r2 = 0.7694309805814495, training RMSE = 1.0611540504620793, validation r2 = 0.7363136038910802, validation RMSE = 1.173449604587168
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[233]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epsilon = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>epsilon = 0.9, Training r2 = 0.7648842437250406, training RMSE = 1.0715657574433184, validation r2 = 0.7288774470764732, validation RMSE = 1.189880653392395
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[234]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
<span class="n">r2Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_kpca</span><span class="p">)</span>
<span class="n">r2Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epsilon = </span><span class="si">{}</span><span class="s2">, Training r2 = </span><span class="si">{}</span><span class="s2">, training RMSE = </span><span class="si">{}</span><span class="s2">, validation r2 = </span><span class="si">{}</span><span class="s2">, validation RMSE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">r2Train</span><span class="p">,</span> <span class="n">RMSE_Train</span><span class="p">,</span> <span class="n">r2Test</span><span class="p">,</span> <span class="n">RMSE_Test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>epsilon = 0.2, Training r2 = 0.7689042658690418, training RMSE = 1.0623654157442552, validation r2 = 0.7385191241553051, validation RMSE = 1.1685318283281179
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>I tested several epsilon values and I could not improve the score. In most cases the $R^2$ values and RMSE values did not change much, but in some cases it lowered. I think that the reason I did not see much change in these cases is that the default values may fit the model more effectively than the new values I tried to insert<a rel="noopener" class="anchor-link" href="#I-tested-several-epsilon-values-and-I-could-not-improve-the-score.-In-most-cases-the-$R^2$-values-and-RMSE-values-did-not-change-much,-but-in-some-cases-it-lowered.-I-think-that-the-reason-I-did-not-see-much-change-in-these-cases-is-that-the-default-values-may-fit-the-model-more-effectively-than-the-new-values-I-tried-to-insert">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q9 [10]<a rel="noopener" class="anchor-link" href="#Q9-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Using the Support Vector Classifier :<ul>
<li>Think of other ways of improving the clasification performance and list at least two possibilities.</li>
<li>You can use any of the datasets we have been using (standardized data, PCA transformed data or the Kernel PCA transformed data), or re-create your own set from the original.</li>
<li>Implement both of the methods you proposed. </li>
<li>Is the validation performance increasing? For performance comparison you can use any classification performance metric that you deem to be appropriate.</li>
<li>If both of them did not improve, comment on why this might have been the case. What else can be done?</li>
<li>Optional: Apply different methods, ideas as you see fit and see if the validation performance is improving.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Two ways of improving the support vector classifier are by changing the tol (tolerance level for stopping) or changing the probability to true<a rel="noopener" class="anchor-link" href="#Two-ways-of-improving-the-support-vector-classifier-are-by-changing-the-tol-(tolerance-level-for-stopping)-or-changing-the-probability-to-true">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Original Classifier:<a rel="noopener" class="anchor-link" href="#Original-Classifier:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[235]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training Accuracy Score: </span><span class="si">{}</span><span class="s1">, Validation Accuracy Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracyTrain</span><span class="p">,</span> <span class="n">accuracyTest</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training Accuracy Score: 0.9453880885831004, Validation Accuracy Score: 0.9242728184553661
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[236]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[236]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1118,   77],
       [  74,  725]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[237]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Recall</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F1Score</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall: </span><span class="si">{}</span><span class="s1">, Specificity: </span><span class="si">{}</span><span class="s1">, Precision: </span><span class="si">{}</span><span class="s1">, Balanced Accuracy: </span><span class="si">{}</span><span class="s1">, F1 Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Recall</span><span class="p">,</span> <span class="n">specificity</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">BalancedAccuracy</span><span class="p">,</span> <span class="n">F1Score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recall: 0.9073842302878599, Specificity: 0.9355648535564853, Precision: 0.9039900249376559, Balanced Accuracy: 0.9214745419221726, F1 Score: 0.905683947532792
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Grid Search for Optimal Parameters:<a rel="noopener" class="anchor-link" href="#Grid-Search-for-Optimal-Parameters:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[238]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
    <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[239]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>

<span class="n">print_results</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>BEST PARAMS: {&#39;probability&#39;: True, &#39;tol&#39;: 0.08}

0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.001}
0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.002}
0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.005}
0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.008}
0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.01}
0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.05}
0.919 (+/-0.011) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.08}
0.919 (+/-0.01) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.1}
0.918 (+/-0.01) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.5}
0.915 (+/-0.013) for {&#39;probability&#39;: True, &#39;tol&#39;: 0.9}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.001}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.002}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.005}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.008}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.01}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.05}
0.919 (+/-0.011) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.08}
0.919 (+/-0.01) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.1}
0.918 (+/-0.01) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.5}
0.915 (+/-0.013) for {&#39;probability&#39;: False, &#39;tol&#39;: 0.9}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[240]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
<span class="n">TrainPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">accuracyTrain</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training Accuracy Score: </span><span class="si">{}</span><span class="s1">, Validation Accuracy Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracyTrain</span><span class="p">,</span> <span class="n">accuracyTest</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training Accuracy Score: 0.9456030961083638, Validation Accuracy Score: 0.9247743229689067
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[241]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[241]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1117,   78],
       [  72,  727]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[242]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Recall</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F1Score</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall: </span><span class="si">{}</span><span class="s1">, Specificity: </span><span class="si">{}</span><span class="s1">, Precision: </span><span class="si">{}</span><span class="s1">, Balanced Accuracy: </span><span class="si">{}</span><span class="s1">, F1 Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Recall</span><span class="p">,</span> <span class="n">specificity</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">BalancedAccuracy</span><span class="p">,</span> <span class="n">F1Score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recall: 0.9098873591989988, Specificity: 0.9347280334728033, Precision: 0.9031055900621118, Balanced Accuracy: 0.922307696335901, F1 Score: 0.9064837905236908
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Overall, there was not a major change in the newly modified classifier. I did observe the following differences through the confusion matrix. The newly tuned model had 1 less true negative value, 1 more false positive value, 2 less false negative values and 2 more true positive values.<a rel="noopener" class="anchor-link" href="#Overall,-there-was-not-a-major-change-in-the-newly-modified-classifier.-I-did-observe-the-following-differences-through-the-confusion-matrix.-The-newly-tuned-model-had-1-less-true-negative-value,-1-more-false-positive-value,-2-less-false-negative-values-and-2-more-true-positive-values.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Q10 [10]<a rel="noopener" class="anchor-link" href="#Q10-[10]">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Choose at least (the best) 3 regressors among the trained regressions models:</li>
<li>Create a table summarizing results on the <strong>test</strong> set for regression (with target variables in <code>y_test</code>):<ul>
<li>Show the regression performance metric of your choice on test data for each model.</li>
</ul>
</li>
<li>Which model is best for regression? Is this in line with your analysis or is this not expected?</li>
</ul>
<ul>
<li>Choose as least (the best) 3 classifiers among the trained classification models:</li>
<li>Create a table summarizing results on the <strong>test</strong> set for classification (with target variables in <code>y_test_cat</code>):<ul>
<li>Show the classification performance metric of your choice on test data for each model. </li>
</ul>
</li>
<li>Which model is best for classification? Is this in line with your analysis or is this not expected? </li>
</ul>
<blockquote><p>Note that the same transformation used during training should be applied on the testing set. (If you applied PCA on training data for the selected model, you need to apply PCA on the testing set as well.)</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Regressors<a rel="noopener" class="anchor-link" href="#Regressors">&#182;</a></h1><h3>Model 1 -&gt; SVR with kpca:<a rel="noopener" class="anchor-link" href="#Model-1--&gt;-SVR-with-kpca:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[243]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">kpca</span> <span class="o">=</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">remove_zero_eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="s1">&#39;RandomState&#39;</span><span class="p">)</span>
<span class="n">kpca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">X_test_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[244]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[245]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[245]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=10, gamma=0.5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[246]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[247]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[247]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7684172900202348</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[248]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[248]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.063484159983866</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[249]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[250]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[250]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7190718721222846</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[251]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[251]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1930458378132294</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Linear Regression with KPCA<a rel="noopener" class="anchor-link" href="#Linear-Regression-with-KPCA">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[252]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[253]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[253]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[254]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[255]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[255]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7580770439351178</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[256]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[256]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.086967352556054</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[257]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[258]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[258]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7066384838562579</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[259]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[259]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.219161074906627</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>SVR with regular data<a rel="noopener" class="anchor-link" href="#SVR-with-regular-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[260]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[261]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svr_rbf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[261]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVR(C=10, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[262]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TrainPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[263]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[263]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7667524817588922</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[264]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Train</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TrainPred</span><span class="p">)</span>
<span class="n">RMSE_Train</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Train</span><span class="p">)</span>
<span class="n">RMSE_Train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[264]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.067299916893449</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[265]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">svr_rbf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[266]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[266]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.7297982560246042</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[267]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MSE_Test</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">RMSE_Test</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_Test</span><span class="p">)</span>
<span class="n">RMSE_Test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[267]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1700477648811283</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[268]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;SVR w/KPCA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">,</span> <span class="mf">1.06</span><span class="p">,</span> <span class="mf">1.19</span><span class="p">],</span> 
          <span class="s1">&#39;Linear Regression w/KPCA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.76</span><span class="p">,</span> <span class="mf">0.71</span><span class="p">,</span> <span class="mf">1.09</span><span class="p">,</span> <span class="mf">1.22</span><span class="p">],</span> 
          <span class="s1">&#39;SVR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">1.07</span><span class="p">,</span> <span class="mf">1.17</span><span class="p">]})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[269]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Train r2&#39;</span><span class="p">,</span> <span class="s1">&#39;Test r2&#39;</span><span class="p">,</span> <span class="s1">&#39;Train RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;Test RMSE&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[269]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Train r2</th>
      <th>Test r2</th>
      <th>Train RMSE</th>
      <th>Test RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SVR w/KPCA</th>
      <td>0.77</td>
      <td>0.72</td>
      <td>1.06</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>Linear Regression w/KPCA</th>
      <td>0.76</td>
      <td>0.71</td>
      <td>1.09</td>
      <td>1.22</td>
    </tr>
    <tr>
      <th>SVR</th>
      <td>0.77</td>
      <td>0.73</td>
      <td>1.07</td>
      <td>1.17</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4>The model that works the best with the testing data is the Support Vector Regressor with the standardized data. The Support Vector Regressor worked well throughout this project, so it is not surprising to me that it performed well. I would have predicted that the Support Vector Regressor with the KPCA data would have outperformed the other model, so that was a bit of a surprise.<a rel="noopener" class="anchor-link" href="#The-model-that-works-the-best-with-the-testing-data-is-the-Support-Vector-Regressor-with-the-standardized-data.-The-Support-Vector-Regressor-worked-well-throughout-this-project,-so-it-is-not-surprising-to-me-that-it-performed-well.-I-would-have-predicted-that-the-Support-Vector-Regressor-with-the-KPCA-data-would-have-outperformed-the-other-model,-so-that-was-a-bit-of-a-surprise.">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Classifiers<a rel="noopener" class="anchor-link" href="#Classifiers">&#182;</a></h1><h3>Model 1 -&gt; SVC with normal data<a rel="noopener" class="anchor-link" href="#Model-1--&gt;-SVC-with-normal-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[270]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[271]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[271]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVC(C=10, gamma=0.5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[272]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[273]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[273]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9201623815967523</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[274]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[274]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[410,  28],
       [ 31, 270]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[275]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Recall</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F1Score</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall: </span><span class="si">{}</span><span class="s1">, Specificity: </span><span class="si">{}</span><span class="s1">, Precision: </span><span class="si">{}</span><span class="s1">, Balanced Accuracy: </span><span class="si">{}</span><span class="s1">, F1 Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Recall</span><span class="p">,</span> <span class="n">specificity</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">BalancedAccuracy</span><span class="p">,</span> <span class="n">F1Score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recall: 0.8970099667774086, Specificity: 0.9360730593607306, Precision: 0.9060402684563759, Balanced Accuracy: 0.9165415130690696, F1 Score: 0.9015025041736227
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Model 2 -&gt; SVC with PCA data<a rel="noopener" class="anchor-link" href="#Model-2--&gt;-SVC-with-PCA-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[276]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[277]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[277]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVC(C=10, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[278]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[279]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[279]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9201623815967523</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[280]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[280]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[419,  19],
       [ 40, 261]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[281]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Recall</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F1Score</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall: </span><span class="si">{}</span><span class="s1">, Specificity: </span><span class="si">{}</span><span class="s1">, Precision: </span><span class="si">{}</span><span class="s1">, Balanced Accuracy: </span><span class="si">{}</span><span class="s1">, F1 Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Recall</span><span class="p">,</span> <span class="n">specificity</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">BalancedAccuracy</span><span class="p">,</span> <span class="n">F1Score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recall: 0.867109634551495, Specificity: 0.95662100456621, Precision: 0.9321428571428572, Balanced Accuracy: 0.9118653195588525, F1 Score: 0.8984509466437177
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>SVC with KPCA<a rel="noopener" class="anchor-link" href="#SVC-with-KPCA">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[282]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[283]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[283]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>SVC(C=5, gamma=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[284]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">TestPred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_kpca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[285]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">accuracyTest</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">accuracyTest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[285]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9282814614343707</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[286]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">TestPred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[286]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[419,  19],
       [ 34, 267]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[287]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Recall</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">specificity</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F1Score</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">TestPred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall: </span><span class="si">{}</span><span class="s1">, Specificity: </span><span class="si">{}</span><span class="s1">, Precision: </span><span class="si">{}</span><span class="s1">, Balanced Accuracy: </span><span class="si">{}</span><span class="s1">, F1 Score: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Recall</span><span class="p">,</span> <span class="n">specificity</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">BalancedAccuracy</span><span class="p">,</span> <span class="n">F1Score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recall: 0.8870431893687708, Specificity: 0.95662100456621, Precision: 0.9335664335664335, Balanced Accuracy: 0.9218320969674905, F1 Score: 0.9097103918228279
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[288]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;SVC with Reg Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">],</span> 
          <span class="s1">&#39;SVC with PCA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">],</span> 
          <span class="s1">&#39;SVC with KPCA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.89</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">]})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[289]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[290]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;Specificity&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Balanced Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[290]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recall</th>
      <th>Specificity</th>
      <th>Precision</th>
      <th>Balanced Accuracy</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SVC with Reg Data</th>
      <td>0.90</td>
      <td>0.94</td>
      <td>0.91</td>
      <td>0.92</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>SVC with PCA</th>
      <td>0.87</td>
      <td>0.96</td>
      <td>0.93</td>
      <td>0.91</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>SVC with KPCA</th>
      <td>0.89</td>
      <td>0.96</td>
      <td>0.93</td>
      <td>0.92</td>
      <td>0.91</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>The top performer classifier would be the first Support Vector Classifier with normalized data. The Support Vector Classifier worked well with all of the data, but both the PCA and KPCA data performed slightly lower. I saw that the data before being transformed worked well initially, so this is not a big surprise for me.<a rel="noopener" class="anchor-link" href="#The-top-performer-classifier-would-be-the-first-Support-Vector-Classifier-with-normalized-data.-The-Support-Vector-Classifier-worked-well-with-all-of-the-data,-but-both-the-PCA-and-KPCA-data-performed-slightly-lower.-I-saw-that-the-data-before-being-transformed-worked-well-initially,-so-this-is-not-a-big-surprise-for-me.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>What did you learn in this project? Any suggestions?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>I learned a lot about using different regressors and classifiers and how to compare them. This was my first time performing kernel pca and I enjoyed getting exposure to that new content. I appreciate the opportunity to compare multiple classifiers and identify the differences between them. Comparing the strengths and weaknesses of different models is something that I find enjoyable and interesting.<a rel="noopener" class="anchor-link" href="#I-learned-a-lot-about-using-different-regressors-and-classifiers-and-how-to-compare-them.-This-was-my-first-time-performing-kernel-pca-and-I-enjoyed-getting-exposure-to-that-new-content.-I-appreciate-the-opportunity-to-compare-multiple-classifiers-and-identify-the-differences-between-them.-Comparing-the-strengths-and-weaknesses-of-different-models-is-something-that-I-find-enjoyable-and-interesting.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Thank you<a rel="noopener" class="anchor-link" href="#Thank-you">&#182;</a></h1><p>ilyas</p>

</div>
</div>
</div>
    </div>
  </div>


 



<script type="text/javascript" src="/d2l/common/math/MathML.js?v=20.21.12.34125 "></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() { D2LMathML.DesktopInit('https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=MML_HTMLorMML','https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML','130',false); });</script></body></html>